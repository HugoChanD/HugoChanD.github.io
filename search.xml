<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[部署Hexo到vps]]></title>
      <url>http://www.hugospi.com/2017-01-05/hexo-VPSbak/</url>
      <content type="html"><![CDATA[<p>&#x539F;&#x5148;&#x90E8;&#x7F72;&#x5728;github&#x4E0A;&#x867D;&#x7136;&#x5F88;&#x65B9;&#x4FBF;&#xFF0C;&#x4F46;&#x662F;&#x901F;&#x5EA6;&#x5F88;&#x8BA9;&#x4EBA;&#x6293;&#x6025;<br>&#x4E70;&#x7684;VPS&#x76EE;&#x524D;&#x53EA;&#x662F;&#x7528;&#x6765;&#x79D1;&#x5B66;&#x4E0A;&#x7F51;&#xFF0C;&#x6700;&#x540E;&#x60F3;&#x4E86;&#x4E0B;&#x8FD8;&#x662F;&#x628A;hexo&#x90E8;&#x7F72;&#x5230;vps&#x4E0A;&#x5427;</p>
<p>1.VPS&#x4E0A;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#&#x5B89;&#x88C5;git</span></div><div class="line">yum install git</div><div class="line"><span class="comment">#&#x65B0;&#x5EFA;git&#x7528;&#x6237;</span></div><div class="line">useradd <span class="_">-d</span> /home/git -m git -p passwd</div></pre></td></tr></table></figure></p>
<a id="more"></a>
<p>1.1 &#x914D;&#x7F6E;ssh&#x514D;&#x5BC6;&#x767B;&#x5F55;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">su git</div><div class="line">mkdir ~/.ssh</div><div class="line">vim ~/.ssh/authorized_keys</div><div class="line"><span class="comment">#&#x5C06;&#x672C;&#x5730;&#x7535;&#x8111;&#x7684;id\_rsa.pub&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x7C98;&#x8D34;&#x5230;authorized\_keys&#x6587;&#x4EF6;&#xFF0C;&#x4FDD;&#x5B58;</span></div><div class="line"><span class="comment">#&#x4FEE;&#x6539;&#x6743;&#x9650;&#x907F;&#x514D;&#x4E0D;&#x80FD;&#x6B63;&#x5E38;&#x767B;&#x5F55;</span></div><div class="line">chmod 700 ~/.ssh</div><div class="line">chmod 600 ~/.ssh/authorized_keys</div></pre></td></tr></table></figure></p>
<p>1.2 &#x521B;&#x5EFA;&#x4ED3;&#x5E93;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span></div><div class="line">mkdir hexo.git &amp;&amp; <span class="built_in">cd</span> hexo.git</div><div class="line">git init --bare</div></pre></td></tr></table></figure></p>
<p>&#x4FEE;&#x6539;&#x7F51;&#x7AD9;&#x6839;&#x76EE;&#x5F55;&#x6743;&#x9650;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">su root</div><div class="line">chown git:git /home/wwwroot/blog</div></pre></td></tr></table></figure></p>
<p>1.3 &#x5229;&#x7528; Git Hooks &#x5B9E;&#x73B0;&#x81EA;&#x52A8;&#x90E8;&#x7F72;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">su git </div><div class="line">#&#x521B;&#x5EFA;&#x7F13;&#x5B58;&#x4ED3;&#x5E93;&#x76EE;&#x5F55;</div><div class="line">mkdir ~/git/tmp/hexo_tmp</div><div class="line">cd ~/hexo.git/hooks</div><div class="line">vim post-receive</div></pre></td></tr></table></figure></p>
<p>&#x6DFB;&#x52A0;&#x4EE5;&#x4E0B;&#x5185;&#x5BB9;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/bin/bash -l</span></div><div class="line">GIT_REPO=/home/git/hexo.git</div><div class="line">TMP_GIT_CLONE=/home/git/tmp/hexo_tmp</div><div class="line">PUBLIC_WWW=/home/wwwroot/blog</div><div class="line">rm -rf <span class="variable">${TMP_GIT_CLONE}</span></div><div class="line">git <span class="built_in">clone</span> <span class="variable">$GIT_REPO</span> <span class="variable">$TMP_GIT_CLONE</span></div><div class="line">rm -rf <span class="variable">${PUBLIC_WWW}</span>/*</div><div class="line">cp -rf <span class="variable">${TMP_GIT_CLONE}</span>/* <span class="variable">${PUBLIC_WWW}</span></div></pre></td></tr></table></figure></p>
<p>&#x52A0;&#x4E0A;&#x6267;&#x884C;&#x6743;&#x9650;chmod +x post-receive</p>
<p>1.4 &#x7F16;&#x8F91;&#x914D;&#x7F6E;nginx<br>vim /usr/local/nginx/conf/nginx.conf<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">server {</div><div class="line">index index.html index.htm;</div><div class="line">root   /home/wwwroot/blog;</div><div class="line">server_name hugospi.com;  <span class="comment">#&#x4FEE;&#x6539;&#x57DF;&#x540D;</span></div><div class="line">location / {</div><div class="line">    try_files <span class="variable">$uri</span> <span class="variable">$uri</span>/ /index.html;</div><div class="line"> }</div><div class="line">}</div></pre></td></tr></table></figure></p>
<p>&#x6700;&#x540E;&#x91CD;&#x542F;nginx<br>service nginx restart</p>
<p>2.&#x672C;&#x5730;&#x914D;&#x7F6E;<br>&#x7F16;&#x8F91;hexo&#x914D;&#x7F6E;&#x6587;&#x4EF6;_config.xml<br>&#x5728;&#x6700;&#x540E;&#x6DFB;&#x52A0;VPS&#x4ED3;&#x5E93;&#x5730;&#x5740;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">deploy:</div><div class="line"><span class="built_in">type</span>: git</div><div class="line">repo:</div><div class="line">    github: git@github.com:HugoChanD/HugoChanD.github.io.git,master</div><div class="line">    VPS: git@vps ip&#x5730;&#x5740;:hexo.git,master</div></pre></td></tr></table></figure></p>
<p>&#x540C;&#x6B65;&#x90E8;&#x7F72;hexo d -g</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[hexo提示Cannot find module的解决方法]]></title>
      <url>http://www.hugospi.com/2017-01-05/hexo-MODULE-NOT-FOUND/</url>
      <content type="html"><![CDATA[<p>&#x95EE;&#x9898;&#xFF1A;&#x5728;&#x4F7F;&#x7528;hexo&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x9047;&#x89C1;&#x4EE5;&#x4E0B;&#x95EE;&#x9898;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">{ [Error: Cannot find module <span class="string">&apos;./build/Release/DTraceProviderBindings&apos;</span>] code: <span class="string">&apos;MODULE_NOT_FOUND&apos;</span> }</div><div class="line">{ [Error: Cannot find module <span class="string">&apos;./build/default/DTraceProviderBindings&apos;</span>] code: <span class="string">&apos;MODULE_NOT_FOUND&apos;</span> }</div><div class="line">{ [Error: Cannot find module <span class="string">&apos;./build/Debug/DTraceProviderBindings&apos;</span>] code: <span class="string">&apos;MODULE_NOT_FOUND&apos;</span> }</div></pre></td></tr></table></figure></p>
<p>&#x641C;&#x7D22;&#x4E86;&#x4E0B;&#x5927;&#x90E8;&#x5206;&#x90FD;&#x662F;&#x7528; npm install hexo &#x2013;no-optional &#x89E3;&#x51B3;&#xFF0C;&#x4F46;&#x662F;&#x6211;&#x8BD5;&#x4E86;&#x8FD8;&#x662F;&#x4E0D;&#x8D77;&#x4F5C;&#x7528;</p>
<p>&#x5728;hexo&#x76EE;&#x5F55;&#x4E0B;&#x53D1;&#x73B0;&#x6709;DTraceProviderBindings&#x8FD9;&#x4E2A;&#x6A21;&#x677F;&#xFF0C;&#x8FD9;&#x4E2A;&#x6A21;&#x5757;&#x7528;&#x4E8E;&#x8C03;&#x8BD5;&#x65F6;&#x63D0;&#x4F9B;&#x66F4;&#x9AD8;&#x7EA7;&#x7684;&#x4FE1;&#x606F;</p>
<p>&#x6700;&#x540E;&#x8FD9;&#x6837;&#x89E3;&#x51B3;&#xFF1A;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">npm uninstall dtrace-provider</div><div class="line">npm install dtrace-provider</div></pre></td></tr></table></figure></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[树莓派利用ffmpeg推流到直播平台]]></title>
      <url>http://www.hugospi.com/2017-01-05/raspberry-ffmpeglive/</url>
      <content type="html"><![CDATA[<p>1.&#x5B89;&#x88C5;ffmpeg<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install ffmpeg</div></pre></td></tr></table></figure></p>
<p>2.&#x591A;&#x89C6;&#x9891;&#x6587;&#x4EF6;&#x76F4;&#x64AD;&#x63A8;&#x6D41;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#&#x968F;&#x673A;&#x64AD;&#x653E;&#x6DFB;&#x52A0;&#x7535;&#x5F71;&#x540D;&#x5230;&#x89C6;&#x9891;&#x53F3;&#x4E0A;&#x89D2;</span></div><div class="line"><span class="keyword">for</span>((;;)); <span class="keyword">do</span> i=`ls *.flv | sort -R | head -n1`  &amp;&amp; ffmpeg -re -i <span class="variable">$i</span> -acodec copy -vcodec libx264 -preset veryfast   -vf  <span class="string">&quot;drawtext=fontsize=15:fontcolor=white:fontfile=/usr/share/fonts/TTF/ziti.TTF:text=&apos;&#x7535;&#x5F71;&#x540D;\:<span class="variable">${i%%.*}</span>&apos;:x=w-tw&quot;</span> -acodec libmp3lame -b:a 96k -ar 44100  <span class="_">-f</span> flv <span class="string">&quot;rtmp://xl.live-send.acg.tv/live-xl/?streamname=live_19040159_8820556&amp;key=15aadc9874f098fdcd17d08f03566f02&quot;</span>;sleep 1;<span class="keyword">done</span></div></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#x5176;&#x4E2D;&#x201C;rtmp://xl.live-send.acg.tv/live-xl/?streamname=live\_19040159\_8820556&amp;key=15aadc9874f098fdcd17d08f03566f02&#x201D;&#x4E3A;&#x63A8;&#x6D41;&#x5730;&#x5740;&#xFF0C;&#x83B7;&#x53D6;&#x65B9;&#x5F0F;&#x662F;&#x5F00;&#x64AD;&#x4E4B;&#x540E;rtmp&#x5730;&#x5740;+&#x76F4;&#x64AD;&#x7801;</div></pre></td></tr></table></figure>
<p>&#x5177;&#x4F53;ffmpeg&#x53C2;&#x6570;&#x53EF;&#x4EE5;&#x5230;&#x5B98;&#x7F51;&#x67E5;&#x8BE2;<br><a href="https://ffmpeg.org/documentation.html" rel="external nofollow noopener noreferrer" target="_blank">https://ffmpeg.org/documentation.html</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[编译php出现 [sapi/cli/php] Error 1 解决办法]]></title>
      <url>http://www.hugospi.com/2016-12-27/linux-php-error/</url>
      <content type="html"><![CDATA[<p>&#x7F16;&#x8BD1;php make&#x7684;&#x65F6;&#x5019;&#x51FA;&#x73B0;&#x4EE5;&#x4E0B;&#x9519;&#x8BEF;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">collect2: ld returned 1 <span class="built_in">exit</span> status</div><div class="line">make: *** [sapi/cli/php] Error 1</div></pre></td></tr></table></figure></p>
<p>google&#x4E4B;&#xFF0C;&#x4EE5;&#x6B64;&#x8BB0;&#x5F55;&#x4E0B;</p>
<p>&#x5728;&#x5B89;&#x88DD; PHP &#x5230;&#x7CFB;&#x7EDF;&#x4E2D;&#x65F6;&#x8981;&#x662F;&#x53D1;&#x751F;&#x300C;undefined reference to libiconv_open&#x2019;&#x300D;&#x4E4B;&#x7C7B;&#x7684;&#x9519;&#x8BEF;&#x4FE1;&#x606F;&#xFF0C;<br>&#x90A3;&#x8868;&#x793A;&#x5728;&#x300C;./configure &#x300D;&#x6C92;&#x6293;&#x597D;&#x4E00;&#x4E9B;&#x73AF;&#x5883;&#x53D8;&#x6570;&#x503C;&#x3002;&#x9519;&#x8BEF;&#x53D1;&#x751F;&#x70B9;&#x5728;&#x5EFA;&#x7ACB;&#x300C;-o sapi/cli/php&#x300D;&#x662F;&#x51FA;&#x9519;&#xFF0C;<br>&#x6CA1;&#x7D66;&#x5230;&#x8981; link &#x7684; iconv &#x51FD;&#x5F0F;&#x5E93;&#x53C2;&#x6570;&#x3002; </p>
<p>&#x89E3;&#x51B3;&#x65B9;&#x6CD5;&#xFF1A;</p>
<p>&#x7F16;&#x8F91;Makefile &#x67E5;&#x627E;&#x7C7B;&#x4F3C; EXTRA_LIBS = &#x2026;.. -lcrypt &#x5728;&#x6700;&#x540E;&#x52A0;&#x4E0A; -liconv&#xFF0C;&#x4F8B;&#x5982;:<br>EXTRA_LIBS = &#x2026;.. -lcrypt -liconv &#x7136;&#x540E;&#x91CD;&#x65B0;&#x518D;&#x6B21; make &#x5373;&#x53EF;&#x3002;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[编译安装Mysql(转载)]]></title>
      <url>http://www.hugospi.com/2016-12-27/linux-mysql/</url>
      <content type="html"><![CDATA[<p>1.&#x5B89;&#x88C5;&#x4F9D;&#x8D56;&#x5305;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum -y install make gcc-c++ cmake bison-devel  ncurses-devel</div></pre></td></tr></table></figure></p>
<p>2.&#x4E0B;&#x8F7D;mysql<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">wget http://101.110.118.68/cdn.mysql.com/Downloads/MySQL-5.5/mysql-5.5.54.tar.gz</div><div class="line">tar -zxvf mysql-5.5.54.tar.gz</div><div class="line"><span class="built_in">cd</span> mysql-5.5.54</div></pre></td></tr></table></figure></p>
<a id="more"></a>
<p>3.&#x7F16;&#x8BD1;&#x5B89;&#x88C5;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">cmake \</div><div class="line">-DCMAKE_INSTALL_PREFIX=/usr/<span class="built_in">local</span>/mysql \</div><div class="line">-DMYSQL_DATADIR=/usr/<span class="built_in">local</span>/mysql/data \</div><div class="line">-DSYSCONFDIR=/etc \</div><div class="line">-DWITH_MYISAM_STORAGE_ENGINE=1 \</div><div class="line">-DWITH_INNOBASE_STORAGE_ENGINE=1 \</div><div class="line">-DWITH_MEMORY_STORAGE_ENGINE=1 \</div><div class="line">-DWITH_READLINE=1 \</div><div class="line">-DMYSQL_UNIX_ADDR=/var/lib/mysql/mysql.sock \</div><div class="line">-DMYSQL_TCP_PORT=3306 \</div><div class="line">-DENABLED_LOCAL_INFILE=1 \</div><div class="line">-DWITH_PARTITION_STORAGE_ENGINE=1 \</div><div class="line">-DEXTRA_CHARSETS=all \</div><div class="line">-DDEFAULT_CHARSET=utf8 \</div><div class="line">-DDEFAULT_COLLATION=utf8_general_ci</div><div class="line"></div><div class="line">make &amp;&amp; make install</div></pre></td></tr></table></figure></p>
<p>&#x7F16;&#x8BD1;&#x53C2;&#x6570;&#x8BF4;&#x660E;&#xFF1A;<a href="http://dev.mysql.com/doc/refman/5.5/en/source-configuration-options.html" rel="external nofollow noopener noreferrer" target="_blank">http://dev.mysql.com/doc/refman/5.5/en/source-configuration-options.html</a></p>
<p>4.&#x914D;&#x7F6E;Mysql</p>
<p>&#x521B;&#x5EFA;mysql&#x7528;&#x6237;&#x4E0E;&#x7EC4;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">groupadd mysql</div><div class="line">useradd -g mysql mysql</div></pre></td></tr></table></figure></p>
<p>&#x4FEE;&#x6539;/usr/local/mysql&#x6743;&#x9650;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chown -R mysql:mysql /usr/<span class="built_in">local</span>/mysql</div></pre></td></tr></table></figure></p>
<p>&#x521D;&#x59CB;&#x5316;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/mysql</div><div class="line"><span class="comment">#&#x521B;&#x5EFA;&#x6570;&#x636E;&#x5E93;&#x548C;&#x8868;</span></div><div class="line">scripts/mysql_install_db --basedir=/usr/<span class="built_in">local</span>/mysql --datadir=/usr/<span class="built_in">local</span>/mysql/data --user=mysql</div></pre></td></tr></table></figure></p>
<p>&#x542F;&#x52A8;Mysql<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#&#x6DFB;&#x52A0;&#x670D;&#x52A1;&#xFF0C;&#x8BBE;&#x7F6E;&#x5F00;&#x673A;&#x542F;&#x52A8;</span></div><div class="line">cp support-files/mysql.server /etc/init.d/mysql</div><div class="line">chkconfig mysql on</div><div class="line">service mysql start</div></pre></td></tr></table></figure></p>
<p>MySQL&#x542F;&#x52A8;&#x6210;&#x529F;&#x540E;&#xFF0C;root&#x9ED8;&#x8BA4;&#x6CA1;&#x6709;&#x5BC6;&#x7801;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x8BBE;&#x7F6E;root&#x5BC6;&#x7801;&#x3002;</p>
<p>&#x8BBE;&#x7F6E;&#x4E4B;&#x524D;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5148;&#x8BBE;&#x7F6E;PATH&#xFF0C;&#x8981;&#x4E0D;&#x4E0D;&#x80FD;&#x76F4;&#x63A5;&#x8C03;&#x7528;mysql</p>
<p>&#x4FEE;&#x6539;/etc/profile&#x6587;&#x4EF6;&#xFF0C;&#x5728;&#x6587;&#x4EF6;&#x672B;&#x5C3E;&#x6DFB;&#x52A0;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">PATH=/usr/<span class="built_in">local</span>/mysql/bin:<span class="variable">$PATH</span></div><div class="line"><span class="built_in">export</span> PATH</div></pre></td></tr></table></figure></p>
<p>&#x914D;&#x7F6E;&#x751F;&#x6548;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">source</span> /etc/profile</div></pre></td></tr></table></figure>
<p>&#x6267;&#x884C;&#x4E0B;&#x9762;&#x7684;&#x547D;&#x4EE4;&#x4FEE;&#x6539;root&#x5BC6;&#x7801;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mysql -uroot  </div><div class="line">mysql&gt; SET PASSWORD = PASSWORD(<span class="string">&apos;123456&apos;</span>);</div></pre></td></tr></table></figure>
<p>&#x82E5;&#x8981;&#x8BBE;&#x7F6E;root&#x7528;&#x6237;&#x53EF;&#x4EE5;&#x8FDC;&#x7A0B;&#x8BBF;&#x95EE;&#xFF0C;&#x6267;&#x884C;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql&gt; GRANT ALL PRIVILEGES ON *.* TO <span class="string">&apos;root&apos;</span>@<span class="string">&apos;172.16.%&apos;</span> IDENTIFIED BY <span class="string">&apos;password&apos;</span> WITH GRANT OPTION;</div></pre></td></tr></table></figure>
<p>&#x914D;&#x7F6E;&#x9632;&#x706B;&#x5899;<br>&#x9632;&#x706B;&#x5899;&#x7684;3306&#x7AEF;&#x53E3;&#x9ED8;&#x8BA4;&#x6CA1;&#x6709;&#x5F00;&#x542F;&#xFF0C;&#x82E5;&#x8981;&#x8FDC;&#x7A0B;&#x8BBF;&#x95EE;&#xFF0C;&#x9700;&#x8981;&#x5F00;&#x542F;&#x8FD9;&#x4E2A;&#x7AEF;&#x53E3;</p>
<p>&#x6253;&#x5F00;/etc/sysconfig/iptables</p>
<p>&#x5728;&#x201C;-A INPUT &#x2013;m state &#x2013;state NEW &#x2013;m tcp &#x2013;p &#x2013;dport 22 &#x2013;j ACCEPT&#x201D;&#xFF0C;&#x4E0B;&#x6DFB;&#x52A0;&#xFF1A;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">-A INPUT -m state --state NEW -m tcp -p -dport 3306 -j ACCEPT</div></pre></td></tr></table></figure></p>
<p>&#x7136;&#x540E;&#x4FDD;&#x5B58;&#xFF0C;&#x5E76;&#x5173;&#x95ED;&#x8BE5;&#x6587;&#x4EF6;&#xFF0C;&#x5728;&#x7EC8;&#x7AEF;&#x5185;&#x8FD0;&#x884C;&#x4E0B;&#x9762;&#x7684;&#x547D;&#x4EE4;&#xFF0C;&#x5237;&#x65B0;&#x9632;&#x706B;&#x5899;&#x914D;&#x7F6E;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">service iptables restart</div></pre></td></tr></table></figure>
<p>OK&#xFF0C;&#x4E00;&#x5207;&#x914D;&#x7F6E;&#x5B8C;&#x6BD5;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x4F60;&#x7684;MySQL&#x4E86;~</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[ffprobe查找视频分辨率大于900的文件]]></title>
      <url>http://www.hugospi.com/2016-12-19/linux-ffprobe/</url>
      <content type="html"><![CDATA[<p>ffmpeg&#x529F;&#x80FD;&#x5F3A;&#x5927;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x547D;&#x4EE4;&#x884C;&#x6765;&#x5BF9;&#x97F3;&#x89C6;&#x9891;&#x8FDB;&#x884C;&#x5904;&#x7406;</p>
<p>1.OSX&#x4E0B;&#x5B89;&#x88C5;ffmpeg<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install ffmpeg</div></pre></td></tr></table></figure></p>
<a id="more"></a>
<p>2.&#x4F7F;&#x7528;ffprobe&#x83B7;&#x53D6;&#x89C6;&#x9891;&#x6587;&#x4EF6;&#x4FE1;&#x606F;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ffprobe -print_format json -show_format -show_streams -i ./video/file.mp4</div></pre></td></tr></table></figure></p>
<pre><code>&#x5176;&#x4E2D;&#xFF1A;  

-print_format json&#xFF08;&#x4EE5;json&#x683C;&#x5F0F;&#x8F93;&#x51FA;&#xFF09;&#xFF0C; 

-show_format&#xFF08;&#x8F93;&#x51FA;&#x5C01;&#x88C5;&#x683C;&#x5F0F;&#x4FE1;&#x606F;&#xFF09;&#xFF0C;

-show_streams&#xFF08;&#x8F93;&#x51FA;&#x6D41;&#x4FE1;&#x606F;)

-i ./video/file.mp4&#xFF08;&#x8F93;&#x5165;&#x6587;&#x4EF6;&#xFF09;
</code></pre><p>3.&#x67E5;&#x627E;&#x5206;&#x8FA8;&#x7387;&#x5927;&#x4E8E;900&#x7684;&#x6587;&#x4EF6;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> *;<span class="keyword">do</span> ffprobe -v quiet -print_format json -show_format -show_streams -i <span class="variable">$i</span>|<span class="keyword">if</span> [ $(jq <span class="string">&apos;.streams[0].width&apos;</span>) <span class="_">-gt</span> <span class="string">&quot;900&quot;</span> ];<span class="keyword">then</span>  <span class="built_in">echo</span> <span class="variable">$i</span> &gt;&gt; file1 ;<span class="keyword">fi</span>;<span class="keyword">done</span></div></pre></td></tr></table></figure></p>
<pre><code>&#x5176;&#x4E2D;jq&#x4E3A;json&#x89E3;&#x6790;&#x5DE5;&#x5177;
</code></pre>]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[自建梯子-搬瓦工搭建Shadowsocks服务加速(转载)]]></title>
      <url>http://www.hugospi.com/2016-12-14/VPS-Shadowsocks/</url>
      <content type="html"><![CDATA[<p>&#x8D2D;&#x4E70;vps&#x53CA;&#x5176;ssh&#x767B;&#x5F55;</p>
<p>1.&#x5B89;&#x88C5;Shadowsocks<br>    &#x4E00;&#x952E;&#x5B89;&#x88C5;shadowsocks-go&#x7248;&#x672C;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">wget --no-check-certificate https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks-go.sh</div><div class="line">chmod +x shadowsocks-go.sh</div><div class="line">./shadowsocks-go.sh 2&gt;&amp;1 | tee shadowsocks-go.log</div></pre></td></tr></table></figure></p>
<a id="more"></a>
<p>&#x5BA2;&#x6237;&#x7AEF;&#x8F6F;&#x4EF6;:<br>    <a href="https://github.com/shadowsocks" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/shadowsocks</a> (&#x5BF9;&#x5E94;&#x7248;&#x672C;&#x4E0B;&#x8F7D;)</p>
<p>3.Shadowsocks&#x4F18;&#x5316;<br>    &#x5B89;&#x88C5;net-speeder &#x4E00;&#x952E;&#x5B89;&#x88C5;&#x811A;&#x672C;</p>
<pre><code>ubuntu:
&#x6267;&#x884C;&#x5982;&#x4E0B; shell &#x547D;&#x4EE4;&#x5373;&#x53EF;&#xFF0C;&#x4E0D;&#x9700;&#x8981;&#x591A;&#x4F59;&#x64CD;&#x4F5C;&#xFF0C;&#x4F1A;&#x81EA;&#x52A8;&#x6DFB;&#x52A0;&#x5F00;&#x673A;&#x542F;&#x52A8;&#x9879;&#x3002;
&#x642C;&#x74E6;&#x5DE5; VPS &#x4EB2;&#x6D4B;&#x6709;&#x6548;&#x3002;
</code></pre><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># &#x6B65;&#x9AA4;1&#xFF1A;</span></div><div class="line">wget --no-check-certificate https://raw.githubusercontent.com/tennfy/debian_netspeeder_tennfy/master/debian_netspeeder_tennfy.sh</div><div class="line"></div><div class="line"><span class="comment"># &#x6B65;&#x9AA4;2&#xFF1A;</span></div><div class="line">chmod a+x debian_netspeeder_tennfy.sh</div><div class="line"></div><div class="line"><span class="comment"># &#x6B65;&#x9AA4;3&#xFF1A;</span></div><div class="line">bash debian_netspeeder_tennfy.sh</div></pre></td></tr></table></figure>
<pre><code>centos:
</code></pre><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">wget --no-check-certificate https://gist.github.com/LazyZhu/dc3f2f84c336a08fd6a5/rawd8aa4bcf955409e28a262ccf52921a65fe49da99/net_speeder_lazyinstall.sh</div><div class="line"></div><div class="line">sh net_speeder_lazyinstall.sh</div></pre></td></tr></table></figure>
<pre><code>centos&#x624B;&#x52A8;&#x5B89;&#x88C5;
</code></pre><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#&#x5148;&#x5B89;&#x88C5;&#x4F9D;&#x8D56;</span></div><div class="line">wget http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm</div><div class="line">rpm -ivh epel-release-X-Y.noarch.rpm</div><div class="line">yum install libnet libpcap libnet-devel libpcap-devel</div><div class="line"></div><div class="line"><span class="comment">#&#x5B89;&#x88C5;&#x4E3B;&#x7A0B;&#x5E8F;</span></div><div class="line">git <span class="built_in">clone</span> https://github.com/snooda/net-speeder</div><div class="line"><span class="built_in">cd</span> /var/net-speeder <span class="comment">#&#x8FD9;&#x4E00;&#x6B65;&#x662F;&#x8FDB;&#x53BB;&#x4E0B;&#x8F7D;&#x7684;&#x6587;&#x4EF6;&#x5939;</span></div><div class="line">sudo chmod +x ./build.sh</div><div class="line">sudo bash ./build.sh -DCOOKED</div><div class="line">sudo cp ./net_speeder /usr/<span class="built_in">local</span>/bin/</div><div class="line"></div><div class="line"><span class="comment">#&#x5F00;&#x673A;&#x542F;&#x52A8;</span></div><div class="line"><span class="built_in">echo</span> <span class="string">&quot;nohup /usr/local/bin/net_speeder venet0 &quot;</span>ip<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1 &amp;&quot;</span> &gt;&gt; /etc/rc.local</div></pre></td></tr></table></figure>
<pre><code>&#x4ECD;&#x540E;&#x53F0;&#x8FD0;&#x884C;
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nohup net_speeder venet0 &quot;ip&quot; &gt; /dev/null 2&gt;&amp;1 &amp;</div></pre></td></tr></table></figure>
<pre><code>bench.sh&#x663E;&#x793A;&#x5F53;&#x524D;&#x6D4B;&#x8BD5;&#x7684;&#x5404;&#x79CD;&#x7CFB;&#x7EDF;&#x4FE1;&#x606F;
</code></pre><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">wget https://github.com/teddysun/across/blob/master/bench.sh</div><div class="line">wget -qO- bench.sh | bash</div></pre></td></tr></table></figure>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[利用aria2突破百度云下载限速]]></title>
      <url>http://www.hugospi.com/2016-10-12/mac-baiduyun-aria2/</url>
      <content type="html"><![CDATA[<p>1.&#x5B89;&#x88C5;aria2<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install aria2</div></pre></td></tr></table></figure></p>
<p>2.&#x914D;&#x7F6E;aria2&#xFF1A;<br>&#x4F7F;&#x7528;rpc&#x6A21;&#x5F0F;&#xFF0C;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x542F;&#x52A8;aria&#x4F1A;&#x5B89;&#x9759;&#x7B49;&#x5F85;&#x4E0B;&#x8F7D;&#x8BF7;&#x6C42;&#xFF0C;&#x9ED8;&#x9ED8;&#x9A7B;&#x7559;&#x540E;&#x53F0;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mkdir ~/.aria2</div><div class="line">vi ~/.aria2/aria2.conf</div></pre></td></tr></table></figure></p>
<a id="more"></a>
<p>&#x7F16;&#x8F91;aria2.conf&#x6587;&#x4EF6;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#&#x7528;&#x6237;&#x540D;</span></div><div class="line"><span class="comment">#rpc-user=user</span></div><div class="line"><span class="comment">#&#x5BC6;&#x7801;</span></div><div class="line"><span class="comment">#rpc-passwd=passwd</span></div><div class="line"><span class="comment">#&#x4E0A;&#x9762;&#x7684;&#x8BA4;&#x8BC1;&#x65B9;&#x5F0F;&#x4E0D;&#x5EFA;&#x8BAE;&#x4F7F;&#x7528;,&#x5EFA;&#x8BAE;&#x4F7F;&#x7528;&#x4E0B;&#x9762;&#x7684;token&#x65B9;&#x5F0F;</span></div><div class="line"><span class="comment">#&#x8BBE;&#x7F6E;&#x52A0;&#x5BC6;&#x7684;&#x5BC6;&#x94A5;</span></div><div class="line"><span class="comment">#rpc-secret=token</span></div><div class="line"><span class="comment">#&#x5141;&#x8BB8;rpc</span></div><div class="line"><span class="built_in">enable</span>-rpc=<span class="literal">true</span></div><div class="line"><span class="comment">#&#x5141;&#x8BB8;&#x6240;&#x6709;&#x6765;&#x6E90;, web&#x754C;&#x9762;&#x8DE8;&#x57DF;&#x6743;&#x9650;&#x9700;&#x8981;</span></div><div class="line">rpc-allow-origin-all=<span class="literal">true</span></div><div class="line"><span class="comment">#&#x5141;&#x8BB8;&#x5916;&#x90E8;&#x8BBF;&#x95EE;&#xFF0C;false&#x7684;&#x8BDD;&#x53EA;&#x76D1;&#x542C;&#x672C;&#x5730;&#x7AEF;&#x53E3;</span></div><div class="line">rpc-listen-all=<span class="literal">true</span></div><div class="line"><span class="comment">#RPC&#x7AEF;&#x53E3;, &#x4EC5;&#x5F53;&#x9ED8;&#x8BA4;&#x7AEF;&#x53E3;&#x88AB;&#x5360;&#x7528;&#x65F6;&#x4FEE;&#x6539;</span></div><div class="line">rpc-listen-port=6801</div><div class="line"><span class="comment">#&#x6700;&#x5927;&#x540C;&#x65F6;&#x4E0B;&#x8F7D;&#x6570;(&#x4EFB;&#x52A1;&#x6570;), &#x8DEF;&#x7531;&#x5EFA;&#x8BAE;&#x503C;: 3</span></div><div class="line">max-concurrent-downloads=5</div><div class="line"><span class="comment">#&#x65AD;&#x70B9;&#x7EED;&#x4F20;</span></div><div class="line"><span class="built_in">continue</span>=<span class="literal">true</span></div><div class="line"><span class="comment">#&#x540C;&#x670D;&#x52A1;&#x5668;&#x8FDE;&#x63A5;&#x6570;</span></div><div class="line">max-connection-per-server=5</div><div class="line"><span class="comment">#&#x6700;&#x5C0F;&#x6587;&#x4EF6;&#x5206;&#x7247;&#x5927;&#x5C0F;, &#x4E0B;&#x8F7D;&#x7EBF;&#x7A0B;&#x6570;&#x4E0A;&#x9650;&#x53D6;&#x51B3;&#x4E8E;&#x80FD;&#x5206;&#x51FA;&#x591A;&#x5C11;&#x7247;, &#x5BF9;&#x4E8E;&#x5C0F;&#x6587;&#x4EF6;&#x91CD;&#x8981;</span></div><div class="line">min-split-size=10M</div><div class="line"><span class="comment">#&#x5355;&#x6587;&#x4EF6;&#x6700;&#x5927;&#x7EBF;&#x7A0B;&#x6570;, &#x8DEF;&#x7531;&#x5EFA;&#x8BAE;&#x503C;: 5</span></div><div class="line">split=10</div><div class="line"><span class="comment">#&#x4E0B;&#x8F7D;&#x901F;&#x5EA6;&#x9650;&#x5236;</span></div><div class="line">max-overall-download-limit=0</div><div class="line"><span class="comment">#&#x5355;&#x6587;&#x4EF6;&#x901F;&#x5EA6;&#x9650;&#x5236;</span></div><div class="line">max-download-limit=0</div><div class="line"><span class="comment">#&#x4E0A;&#x4F20;&#x901F;&#x5EA6;&#x9650;&#x5236;</span></div><div class="line">max-overall-upload-limit=0</div><div class="line"><span class="comment">#&#x5355;&#x6587;&#x4EF6;&#x901F;&#x5EA6;&#x9650;&#x5236;</span></div><div class="line">max-upload-limit=0</div><div class="line"><span class="comment">#&#x65AD;&#x5F00;&#x901F;&#x5EA6;&#x8FC7;&#x6162;&#x7684;&#x8FDE;&#x63A5;</span></div><div class="line"><span class="comment">#lowest-speed-limit=0</span></div><div class="line"><span class="comment">#&#x9A8C;&#x8BC1;&#x7528;&#xFF0C;&#x9700;&#x8981;1.16.1&#x4E4B;&#x540E;&#x7684;release&#x7248;&#x672C;</span></div><div class="line"><span class="comment">#referer=*</span></div><div class="line"><span class="comment">#&#x6587;&#x4EF6;&#x4FDD;&#x5B58;&#x8DEF;&#x5F84;, &#x9ED8;&#x8BA4;&#x4E3A;&#x5F53;&#x524D;&#x542F;&#x52A8;&#x4F4D;&#x7F6E;</span></div><div class="line">dir=/Users/xxx/Downloads</div><div class="line"><span class="comment">#&#x6587;&#x4EF6;&#x7F13;&#x5B58;, &#x4F7F;&#x7528;&#x5185;&#x7F6E;&#x7684;&#x6587;&#x4EF6;&#x7F13;&#x5B58;, &#x5982;&#x679C;&#x4F60;&#x4E0D;&#x76F8;&#x4FE1;Linux&#x5185;&#x6838;&#x6587;&#x4EF6;&#x7F13;&#x5B58;&#x548C;&#x78C1;&#x76D8;&#x5185;&#x7F6E;&#x7F13;&#x5B58;&#x65F6;&#x4F7F;&#x7528;, &#x9700;&#x8981;1.16&#x53CA;&#x4EE5;&#x4E0A;&#x7248;&#x672C;</span></div><div class="line"><span class="comment">#disk-cache=0</span></div><div class="line"><span class="comment">#&#x53E6;&#x4E00;&#x79CD;Linux&#x6587;&#x4EF6;&#x7F13;&#x5B58;&#x65B9;&#x5F0F;, &#x4F7F;&#x7528;&#x524D;&#x786E;&#x4FDD;&#x60A8;&#x4F7F;&#x7528;&#x7684;&#x5185;&#x6838;&#x652F;&#x6301;&#x6B64;&#x9009;&#x9879;, &#x9700;&#x8981;1.15&#x53CA;&#x4EE5;&#x4E0A;&#x7248;&#x672C;(?)</span></div><div class="line"><span class="comment">#enable-mmap=true</span></div><div class="line"><span class="comment">#&#x6587;&#x4EF6;&#x9884;&#x5206;&#x914D;, &#x80FD;&#x6709;&#x6548;&#x964D;&#x4F4E;&#x6587;&#x4EF6;&#x788E;&#x7247;, &#x63D0;&#x9AD8;&#x78C1;&#x76D8;&#x6027;&#x80FD;. &#x7F3A;&#x70B9;&#x662F;&#x9884;&#x5206;&#x914D;&#x65F6;&#x95F4;&#x8F83;&#x957F;</span></div><div class="line"><span class="comment">#&#x6240;&#x9700;&#x65F6;&#x95F4; none &lt; falloc ? trunc &#xAB; prealloc, falloc&#x548C;trunc&#x9700;&#x8981;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x548C;&#x5185;&#x6838;&#x652F;&#x6301;</span></div><div class="line">file-allocation=prealloc</div></pre></td></tr></table></figure></p>
<p>&#x4FEE;&#x6539;&#x9ED8;&#x8BA4;&#x4E0B;&#x8F7D;&#x8DEF;&#x5F84;&#xFF1A;dir=&#x4E0B;&#x8F7D;&#x8DEF;&#x5F84;&#xFF0C;&#x4FDD;&#x5B58;&#x9000;&#x51FA;</p>
<p>3.&#x542F;&#x52A8;aria2<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">aria2c --conf-path=<span class="string">&quot;/Users/xxx/.aria2/aria2.conf&quot;</span> -D</div></pre></td></tr></table></figure></p>
<p>4.&#x4E0B;&#x8F7D;&#x6D4F;&#x89C8;&#x5668;&#x767E;&#x5EA6;&#x4E91;&#x5BFC;&#x51FA;aria2&#x63D2;&#x4EF6;<br><a href="https://github.com/acgotaku/BaiduExporter" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/acgotaku/BaiduExporter</a><br>&#x9009;&#x62E9;&#x5BF9;&#x5E94;&#x7684;&#x6D4F;&#x89C8;&#x5668;&#x5B89;&#x88C5;&#x63D2;&#x4EF6;&#xFF0C;&#x5B89;&#x88C5;&#x540E;&#x6253;&#x5F00;&#x767E;&#x5EA6;&#x4E91;&#x4F1A;&#x53D1;&#x73B0;&#x591A;&#x51FA;&#x4E00;&#x4E2A;&#x5BFC;&#x51FA;&#x4E0B;&#x8F7D;&#x6309;&#x94AE;</p>
<p>&#x76F4;&#x63A5;&#x5728;&#x7EC8;&#x7AEF;&#x4E0B;&#x8F7D;&#x6587;&#x4EF6;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[ESP8266-NodeMCU 使用相关]]></title>
      <url>http://www.hugospi.com/2016-09-30/ESP8266-use/</url>
      <content type="html"><![CDATA[<p>1.&#x4F7F;&#x7528; NodeMCU &#x5FC5;&#x987B;&#x5148;&#x5B89;&#x88C5; CP210x &#x9A71;&#x52A8;:<br><a href="https://www.silabs.com/products/mcu/Pages/USBtoUARTBridgeVCPDrivers.aspx" rel="external nofollow noopener noreferrer" target="_blank">https://www.silabs.com/products/mcu/Pages/USBtoUARTBridgeVCPDrivers.aspx</a></p>
<p>2.&#x4F7F;&#x7528; esptool.py&#x66F4;&#x65B0;&#x56FA;&#x4EF6;<br><a href="https://github.com/themadinventor/esptool" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/themadinventor/esptool</a></p>
<p>&#x56FA;&#x4EF6;&#x4E0B;&#x8F7D;&#x5730;&#x5740;&#xFF1A;<a href="https://github.com/nodemcu/nodemcu-firmware/releases" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/nodemcu/nodemcu-firmware/releases</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./esptool.py --port /dev/ttyUSB1 write_flash  bootloader.bin</div></pre></td></tr></table></figure>
<p>3.&#x4F7F;&#x7528;ESPlorer&#x4E0A;&#x4F20;&#x4EE3;&#x7801;<br><a href="http://esp8266.ru/esplorer/" rel="external nofollow noopener noreferrer" target="_blank">http://esp8266.ru/esplorer/</a><br>&#x4F7F;&#x7528;ESPlorer&#x524D;&#x8981;&#x5148;&#x5B89;&#x88C5;java&#xFF0C;&#x652F;&#x6301;&#x5404;&#x5927;&#x7CFB;&#x7EDF;&#x5E73;&#x53F0;&#x73AF;&#x5883;</p>
<p>&#x542F;&#x52A8;ESPlorer&#x8BBE;&#x5B9A;&#x901A;&#x8BAF;&#x4E3A;9600 &#x6309;&#x4E0B; Open &#x4E0E; NodeMCU &#x8FDE;&#x63A5;</p>
<p>NodeMCU api&#x8BF4;&#x660E;&#xFF1A;<a href="https://github.com/nodemcu/nodemcu-firmware/wiki/nodemcu_api_c" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/nodemcu/nodemcu-firmware/wiki/nodemcu_api_c</a></p>
<p>init.lua&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x5C31;&#x76F8;&#x5F53;&#x4E8E;&#x4EE5;&#x524D;&#x6211;&#x4EEC;DOS&#x7CFB;&#x7EDF;&#x91CC;&#x7684;autoexec.bat&#x6587;&#x4EF6;&#x548C;Linux&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;rc.local&#x6587;&#x4EF6;&#xFF0C;&#x5373;&#x5F00;&#x673A;&#x8FD0;&#x884C;&#x7684;&#x610F;&#x601D;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[树莓派－接入DHT11温湿度传感器]]></title>
      <url>http://www.hugospi.com/2016-09-15/raspberry-DHT11/</url>
      <content type="html"><![CDATA[<p>&#x5229;&#x7528;DHT11&#x6E29;&#x6E7F;&#x5EA6;&#x4F20;&#x611F;&#x5668;&#x83B7;&#x53D6;&#x5BA4;&#x5185;&#x7684;&#x6E29;&#x6E7F;&#x5EA6;&#xFF0C;DHT11&#x4E3B;&#x8981;&#x6709;&#x4E09;&#x4E2A;&#x5F15;&#x811A;:VCC, DATA, GND<br>VCC:&#x7535;&#x6E90;&#x5F15;&#x811A;3-5.5v<br>DATA:&#x6570;&#x636E;&#x5F15;&#x811A;<br>GND:&#x63A5;&#x5730;&#x5F15;&#x811A;</p>
<p>&#x6811;&#x8393;&#x6D3E;3&#x9488;&#x811A;&#x8BF4;&#x660E;&#xFF1A;<a href="http://pinout.xyz/pinout/pin2_5v_power" rel="external nofollow noopener noreferrer" target="_blank">http://pinout.xyz/pinout/pin2_5v_power</a><br><a id="more"></a><br>&#x5F15;&#x811A;&#x8FDE;&#x63A5;&#xFF1A;<br>VCC&#x8FDE;&#x63A5;3.3v &#x8FDE;&#x63A5;1&#x6216;17&#x53E3;<br>DATA&#x8FDE;&#x63A5;GPIO4&#x7B2C;7&#x53E3;<br>GND&#x8FDE;&#x63A5;14&#x63A5;&#x5730;&#x53E3;</p>
<p>C&#x4EE3;&#x7801;&#xFF1A;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div></pre></td><td class="code"><pre><div class="line">/*</div><div class="line"> *  dht11.c:</div><div class="line"> *	Simple <span class="built_in">test</span> program to <span class="built_in">test</span> the wiringPi <span class="built_in">functions</span></div><div class="line"> *	DHT11 <span class="built_in">test</span></div><div class="line"> */</div><div class="line"> </div><div class="line"><span class="comment">#include &lt;wiringPi.h&gt;</span></div><div class="line"> </div><div class="line"><span class="comment">#include &lt;stdio.h&gt;</span></div><div class="line"><span class="comment">#include &lt;stdlib.h&gt;</span></div><div class="line"><span class="comment">#include &lt;stdint.h&gt;</span></div><div class="line"><span class="comment">#define MAXTIMINGS	85</span></div><div class="line"><span class="comment">#define DHTPIN		7</span></div><div class="line">int dht11_dat[5] = { 0, 0, 0, 0, 0 };</div><div class="line"> </div><div class="line">void <span class="function"><span class="title">read_dht11_dat</span></span>()</div><div class="line">{</div><div class="line">	uint8_t laststate	= HIGH;</div><div class="line">	uint8_t counter		= 0;</div><div class="line">	uint8_t j		= 0, i;</div><div class="line">	<span class="built_in">float</span>	f; /* fahrenheit */</div><div class="line"> </div><div class="line">	dht11_dat[0] = dht11_dat[1] = dht11_dat[2] = dht11_dat[3] = dht11_dat[4] = 0;</div><div class="line"> </div><div class="line">	/* pull pin down <span class="keyword">for</span> 18 milliseconds */</div><div class="line">	pinMode( DHTPIN, OUTPUT );</div><div class="line">	digitalWrite( DHTPIN, LOW );</div><div class="line">	delay( 18 );</div><div class="line">	/* <span class="keyword">then</span> pull it up <span class="keyword">for</span> 40 microseconds */</div><div class="line">	digitalWrite( DHTPIN, HIGH );</div><div class="line">	delayMicroseconds( 40 );</div><div class="line">	/* prepare to <span class="built_in">read</span> the pin */</div><div class="line">	pinMode( DHTPIN, INPUT );</div><div class="line"> </div><div class="line">	/* detect change and <span class="built_in">read</span> data */</div><div class="line">	<span class="keyword">for</span> ( i = 0; i &lt; MAXTIMINGS; i++ )</div><div class="line">	{</div><div class="line">		counter = 0;</div><div class="line">		<span class="keyword">while</span> ( digitalRead( DHTPIN ) == laststate )</div><div class="line">		{</div><div class="line">			counter++;</div><div class="line">			delayMicroseconds( 1 );</div><div class="line">			<span class="keyword">if</span> ( counter == 255 )</div><div class="line">			{</div><div class="line">				<span class="built_in">break</span>;</div><div class="line">			}</div><div class="line">		}</div><div class="line">		laststate = digitalRead( DHTPIN );</div><div class="line"> </div><div class="line">		<span class="keyword">if</span> ( counter == 255 )</div><div class="line">			<span class="built_in">break</span>;</div><div class="line"> </div><div class="line">		/* ignore first 3 transitions */</div><div class="line">		<span class="keyword">if</span> ( (i &gt;= 4) &amp;&amp; (i % 2 == 0) )</div><div class="line">		{</div><div class="line">			/* shove each bit into the storage bytes */</div><div class="line">			dht11_dat[j / 8] &lt;&lt;= 1;</div><div class="line">			<span class="keyword">if</span> ( counter &gt; 16 )</div><div class="line">				dht11_dat[j / 8] |= 1;</div><div class="line">			j++;</div><div class="line">		}</div><div class="line">	}</div><div class="line"> </div><div class="line">	/*</div><div class="line">	 * check we <span class="built_in">read</span> 40 bits (8bit x 5 ) + verify checksum <span class="keyword">in</span> the last byte</div><div class="line">	 * <span class="built_in">print</span> it out <span class="keyword">if</span> data is good</div><div class="line">	 */</div><div class="line">	<span class="keyword">if</span> ( (j &gt;= 40) &amp;&amp;</div><div class="line">	     (dht11_dat[4] == ( (dht11_dat[0] + dht11_dat[1] + dht11_dat[2] + dht11_dat[3]) &amp; 0xFF) ) )</div><div class="line">	{</div><div class="line">		f = dht11_dat[2] * 9. / 5. + 32;</div><div class="line">		<span class="built_in">printf</span>( <span class="string">&quot;Humidity = %d.%d %% Temperature = %d.%d *C (%.1f *F)\n&quot;</span>,</div><div class="line">			dht11_dat[0], dht11_dat[1], dht11_dat[2], dht11_dat[3], f );</div><div class="line">	}<span class="keyword">else</span>  {</div><div class="line">		<span class="built_in">printf</span>( <span class="string">&quot;Data not good, skip\n&quot;</span> );</div><div class="line">	}</div><div class="line">}</div><div class="line"> </div><div class="line">int main( void )</div><div class="line">{</div><div class="line">	<span class="built_in">printf</span>( <span class="string">&quot;Raspberry Pi wiringPi DHT11 Temperature test program\n&quot;</span> );</div><div class="line"> </div><div class="line">	<span class="keyword">if</span> ( wiringPiSetup() == -1 )</div><div class="line">		<span class="built_in">exit</span>( 1 );</div><div class="line"> </div><div class="line">	<span class="keyword">while</span> ( 1 )</div><div class="line">	{</div><div class="line">		<span class="built_in">read</span>_dht11_dat();</div><div class="line">		delay( 1000 ); /* <span class="built_in">wait</span> 1sec to refresh */</div><div class="line">	}</div><div class="line"> </div><div class="line">	<span class="built_in">return</span>(0);</div><div class="line">}</div></pre></td></tr></table></figure></p>
<p>&#x7F16;&#x8BD1;&#x8FD0;&#x884C;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">gcc -o dht11 dht11.c -L/usr/<span class="built_in">local</span>/lib -lwiringPi </div><div class="line">sudo ./dht11</div></pre></td></tr></table></figure></p>
<p>&#x611F;&#x8C22;&#x539F;&#x4F5C;&#x8005;;<a href="http://www.uugear.com/portfolio/dht11-humidity-temperature-sensor-module/" rel="external nofollow noopener noreferrer" target="_blank">http://www.uugear.com/portfolio/dht11-humidity-temperature-sensor-module/</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[树莓派－节假日闹钟]]></title>
      <url>http://www.hugospi.com/2016-08-18/raspberry-alarm-clock/</url>
      <content type="html"><![CDATA[<p>&#x8282;&#x5047;&#x65E5;&#x95F9;&#x949F;&#xFF0C;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x901A;&#x8FC7;&#x8FD4;&#x56DE;&#x8282;&#x5047;&#x65E5;&#x6570;&#x636E;&#x5B9A;&#x65F6;&#x64AD;&#x653E;&#x97F3;&#x4E50;</p>
<p>1.&#x6CE8;&#x518C;&#x5E10;&#x53F7;&#x83B7;&#x53D6;api&#x8BA4;&#x8BC1;&#x4FE1;&#x606F;<br>&#x8282;&#x5047;&#x65E5;&#x6570;&#x636E;api:<a href="https://www.showapi.com/api/lookPoint/894" rel="external nofollow noopener noreferrer" target="_blank">https://www.showapi.com/api/lookPoint/894</a></p>
<p>&#x8FD4;&#x56DE;&#x6570;&#x636E;&#x5B9E;&#x4F8B;&#xFF1A;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">{</div><div class="line">    <span class="string">&quot;showapi_res_code&quot;</span>: 0,</div><div class="line">    <span class="string">&quot;showapi_res_error&quot;</span>: <span class="string">&quot;&quot;</span>,</div><div class="line">    <span class="string">&quot;showapi_res_body&quot;</span>: {</div><div class="line">        <span class="string">&quot;begin&quot;</span>: <span class="string">&quot;20161001&quot;</span>,</div><div class="line">        <span class="string">&quot;cn&quot;</span>: <span class="string">&quot;&#x5468;&#x516D;&quot;</span>,</div><div class="line">        <span class="string">&quot;day&quot;</span>: <span class="string">&quot;20161001&quot;</span>,</div><div class="line">        <span class="string">&quot;en&quot;</span>: <span class="string">&quot;Saturday&quot;</span>,</div><div class="line">        <span class="string">&quot;end&quot;</span>: <span class="string">&quot;20161007&quot;</span>,</div><div class="line">        <span class="string">&quot;holiday&quot;</span>: <span class="string">&quot;&#x56FD;&#x5E86;&#x8282;&quot;</span>,</div><div class="line">        <span class="string">&quot;holiday_remark&quot;</span>: <span class="string">&quot;10&#x6708;1&#x65E5;&#x81F3;7&#x65E5;&#x653E;&#x5047;&#x8C03;&#x4F11;&#xFF0C;&#x5171;7&#x5929;&#x3002;10&#x6708;8&#x65E5;&#xFF08;&#x661F;&#x671F;&#x516D;&#xFF09;&#x3001;10&#x6708;9&#x65E5;&#xFF08;&#x661F;&#x671F;&#x65E5;&#xFF09;&#x4E0A;&#x73ED;&#x3002;&quot;</span>,</div><div class="line">        <span class="string">&quot;ret_code&quot;</span>: 0,</div><div class="line">        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;3&quot;</span>,</div><div class="line">        <span class="string">&quot;weekDay&quot;</span>: 6</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure></p>
<a id="more"></a>
<p>&#x8FD9;&#x91CC;&#x6211;&#x53EA;&#x7528;&#x5230;type&#x5B57;&#x6BB5;</p>
<p>&#x540D;&#x79F0;    &#x7C7B;&#x578B;    &#x793A;&#x4F8B;&#x503C;       &#x63CF;&#x8FF0;<br>day    String    20161001    &#x67E5;&#x8BE2;&#x7684;&#x65E5;&#x671F;<br>weekDay    Number    6            &#x661F;&#x671F;&#x51E0;&#x7684;&#x6570;&#x5B57;<br>cn    String    &#x5468;&#x516D;            &#x661F;&#x671F;&#x51E0;&#x7684;&#x4E2D;&#x6587;&#x540D;<br>en    String    Saturday    &#x661F;&#x671F;&#x51E0;&#x7684;&#x82F1;&#x6587;&#x540D;<br>holiday    String    &#x56FD;&#x5E86;&#x8282;            &#x8282;&#x65E5;&#x540D;&#x79F0;&#xFF0C;&#x5DE5;&#x4F5C;&#x65E5;&#x65F6;&#x663E;&#x793A;&#x201C;&#x65E0;&#x201D;&#xFF0C;&#x5468;&#x672B;&#x65F6;&#x663E;&#x793A;&#x201C;&#x5468;&#x672B;&#x201D;&#xFF0C;&#x8282;&#x65E5;&#x65F6;&#x663E;&#x793A;&#x8282;&#x65E5;&#x540D;&#x79F0;<br>holiday_remark    String      10&#x6708;1&#x65E5;&#x81F3;7&#x65E5;&#x653E;&#x5047;&#x8C03;&#x4F11;&#xFF0C;&#x5171;7&#x5929;&#x3002;10&#x6708;8&#x65E5;&#xFF08;&#x661F;&#x671F;&#x516D;&#xFF09;&#x3001;10&#x6708;9&#x65E5;&#xFF08;&#x661F;&#x671F;&#x65E5;&#xFF09;&#x4E0A;&#x73ED;&#x3002;    &#x8282;&#x65E5;&#x5907;&#x6CE8;<br>type    String    1            1&#x4E3A;&#x5DE5;&#x4F5C;&#x65E5;&#xFF0C;2&#x4E3A;&#x5468;&#x672B;&#xFF0C;3&#x4E3A;&#x8282;&#x5047;&#x65E5;<br>begin    String    20161001    &#x8282;&#x65E5;&#x6216;&#x5468;&#x672B;&#x5F00;&#x59CB;&#x65F6;&#x95F4;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x5DE5;&#x4F5C;&#x65E5;&#xFF0C;&#x6B64;&#x5B57;&#x6BB5;&#x4E3A;&#x7A7A;&#x4E32;<br>end    String    20161007    &#x8282;&#x65E5;&#x6216;&#x5468;&#x672B;&#x7ED3;&#x675F;&#x65F6;&#x95F4;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x5DE5;&#x4F5C;&#x65E5;&#xFF0C;&#x6B64;&#x5B57;&#x6BB5;&#x4E3A;&#x7A7A;&#x4E32;</p>
<p>2.&#x5B89;&#x88C5;&#x76F8;&#x5173;&#x4F9D;&#x8D56;</p>
<p>mpg123<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install mpg123</div></pre></td></tr></table></figure></p>
<p>&#x65B0;&#x5EFA;music&#x6587;&#x4EF6;&#x5939;&#x5B58;&#x653E;&#x97F3;&#x4E50;,&#x97F3;&#x4E50;&#x6587;&#x4EF6;&#x6211;&#x7528;music1.mp3,music2.mp3&#x683C;&#x5F0F;&#x547D;&#x540D;&#xFF0C;&#x540E;&#x9762;&#x751F;&#x6210;&#x968F;&#x673A;&#x6570;&#x968F;&#x673A;&#x64AD;&#x653E;&#x97F3;&#x4E50;&#x6587;&#x4EF6;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mkdir music</div><div class="line">touch alarm-clock.py <span class="comment">#&#x65B0;&#x5EFA;python&#x6587;&#x4EF6;</span></div></pre></td></tr></table></figure></p>
<p>python&#x6587;&#x4EF6;&#xFF1A;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">import os</div><div class="line">import sys</div><div class="line">from subprocess import call</div><div class="line">from urllib import    request, parse</div><div class="line">import json</div><div class="line">import random</div><div class="line"></div><div class="line"><span class="comment">#&#x8282;&#x5047;&#x65E5;&#x6570;&#x636E;</span></div><div class="line">def jjrdate():</div><div class="line">    showapi_appid=<span class="string">&quot;apiid&quot;</span>  <span class="comment">#appid</span></div><div class="line">    showapi_sign=<span class="string">&quot;api_sign&quot;</span>   <span class="comment">#api_sign</span></div><div class="line">    url=<span class="string">&quot;http://route.showapi.com/894-1&quot;</span></div><div class="line">    send_data = parse.urlencode([</div><div class="line">    (<span class="string">&apos;showapi_appid&apos;</span>, showapi_appid)</div><div class="line">    ,(<span class="string">&apos;showapi_sign&apos;</span>, showapi_sign)</div><div class="line">     ,(<span class="string">&apos;day&apos;</span>, <span class="string">&quot;&quot;</span>)</div><div class="line">     </div><div class="line">  ])</div><div class="line"> </div><div class="line">    req = request.Request(url)</div><div class="line">    with request.urlopen(req, data=send_data.encode(<span class="string">&apos;utf-8&apos;</span>)) as f:</div><div class="line">      str_res= f.read().decode(<span class="string">&apos;utf-8&apos;</span>)</div><div class="line">      svb_res=json.loads(str_res)</div><div class="line">      date=svb_res[<span class="string">&quot;showapi_res_body&quot;</span>]</div><div class="line">    <span class="built_in">return</span> date</div><div class="line"></div><div class="line"><span class="comment">#&#x95F9;&#x949F;</span></div><div class="line">def aclock():</div><div class="line">        </div><div class="line">    jdate = jjrdate()</div><div class="line">    gzr = int(jdate[<span class="string">&quot;type&quot;</span>])</div><div class="line"></div><div class="line"><span class="comment">#&#x5224;&#x65AD;&#x662F;&#x5426;&#x5DE5;&#x4F5C;&#x65E5;</span></div><div class="line">    <span class="keyword">if</span> gzr == 1:</div><div class="line">        <span class="built_in">return</span>_code = call(<span class="string">&quot;/usr/bin/mpg123 ./music/music&quot;</span> + str(random.randint(1,4)) + <span class="string">&quot;.mp3 &quot;</span>, shell=True)</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__==<span class="string">&apos;__main__&apos;</span>: </div><div class="line">    aclock()</div></pre></td></tr></table></figure></p>
<p>git:<a href="https://github.com/HugoChanD/Raspberry-alarm-clock" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/HugoChanD/Raspberry-alarm-clock</a></p>
<p>&#x6DFB;&#x52A0;crontab &#x6BCF;&#x5929;7:20&#x6267;&#x884C;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">20 7 * * * sudo python3 /home/pi/python/alarm-clock.py</div></pre></td></tr></table></figure></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[树莓派－利用ngrok进行内网穿透]]></title>
      <url>http://www.hugospi.com/2016-08-17/raspberry-ngrok/</url>
      <content type="html"><![CDATA[<p>&#x5BB6;&#x91CC;&#x7684;&#x5C0F;&#x6C34;&#x7BA1;&#x7528;&#x7684;&#x662F;&#x8054;&#x901A;&#x7684;&#x5BBD;&#x5E26;&#xFF0C;&#x524D;&#x4E9B;&#x65E5;&#x5B50;&#x5347;&#x7EA7;&#x5149;&#x7EA4;&#x4E4B;&#x540E;&#x53D1;&#x73B0;ip&#x5730;&#x5740;&#x53D8;&#x6210;&#x4E86;10.<em>.</em>.*&#xFF0C;&#x5185;&#x7F51;&#x2026;<br>&#x6253;&#x7535;&#x8BDD;&#x7ED9;&#x5BA2;&#x670D;&#x8981;&#x6C42;&#x66F4;&#x6362;&#x516C;&#x7F51;ip&#xFF0C;&#x4F30;&#x8BA1;&#x662F;ipv4&#x5730;&#x5740;&#x8D44;&#x6E90;&#x532E;&#x4E4F;&#x6700;&#x7EC8;&#x6295;&#x8BC9;&#x65E0;&#x679C;&#xFF0C;&#x6700;&#x540E;&#x53EA;&#x80FD;&#x901A;&#x8FC7;ngrok<br>&#x8FDB;&#x884C;&#x5185;&#x7F51;&#x7A7F;&#x900F;</p>
<p>ngrok&#x9879;&#x76EE;&#x5730;&#x5740;&#xFF1A;<a href="https://github.com/inconshreveable/ngrok" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/inconshreveable/ngrok</a><br>&#x53EF;&#x4EE5;&#x81EA;&#x884C;&#x7F16;&#x8BD1;&#x642D;&#x5EFA;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x642D;&#x5EFA;&#x597D;&#x7684;&#x670D;&#x52A1;</p>
<p>&#x56FD;&#x5185;&#x670D;&#x52A1;&#x5668;&#xFF1A;<br>ngrok.cc<br>ittun.com<br>natapp.cn<br><a id="more"></a><br>&#x6211;&#x7684;&#x6811;&#x8393;&#x6D3E;&#x4E0D;&#x77E5;&#x9053;&#x4EC0;&#x4E48;&#x539F;&#x56E0;&#x65E0;&#x6CD5;&#x8FD0;&#x884C;ngrok&#x5BA2;&#x6237;&#x7AEF;&#xFF0C;&#x81EA;&#x884C;&#x7F16;&#x8BD1;&#x4E5F;&#x4E0D;&#x884C;&#xFF0C;&#x8FD0;&#x884C;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x63D0;&#x793A;<br>&#x65E0;&#x5948;&#x53EA;&#x80FD;&#x9009;&#x62E9;php&#x5BA2;&#x6237;&#x7AEF;<br><a href="https://github.com/dosgo/ngrok-php" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/dosgo/ngrok-php</a></p>
<p>&#x4FEE;&#x6539;&#x670D;&#x52A1;&#x5668;&#x8DDF;&#x7AEF;&#x53E3;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$seraddr</span> = <span class="string">&apos;ittun.com&apos;</span>; //ngrok&#x670D;&#x52A1;&#x5668;&#x5730;&#x5740;</div><div class="line"><span class="variable">$port</span> = 4443; //&#x7AEF;&#x53E3;</div><div class="line"><span class="variable">$is_verify_peer</span> = <span class="literal">false</span>; //&#x662F;&#x5426;&#x6821;&#x9A8C;&#x8BC1;&#x4E66;</div><div class="line">//&#x4F60;&#x8981;&#x6620;&#x5C04;&#x5230;&#x901A;&#x9053;</div><div class="line"><span class="variable">$Tunnels</span> = array(</div><div class="line">    array(</div><div class="line">        <span class="string">&apos;protocol&apos;</span> =&gt; <span class="string">&apos;http&apos;</span>,</div><div class="line">        <span class="string">&apos;hostname&apos;</span> =&gt; <span class="string">&apos;www.xxx.com&apos;</span>,</div><div class="line">        <span class="string">&apos;subdomain&apos;</span> =&gt; <span class="string">&apos;&apos;</span>,</div><div class="line">        <span class="string">&apos;rport&apos;</span> =&gt; 0,</div><div class="line">        <span class="string">&apos;lhost&apos;</span> =&gt; <span class="string">&apos;127.0.0.1&apos;</span>,</div><div class="line">        <span class="string">&apos;lport&apos;</span> =&gt; 80</div><div class="line">    ),</div><div class="line">    array(</div><div class="line">        <span class="string">&apos;protocol&apos;</span> =&gt; <span class="string">&apos;http&apos;</span>,</div><div class="line">        <span class="string">&apos;hostname&apos;</span> =&gt; <span class="string">&apos;&apos;</span>,</div><div class="line">        <span class="string">&apos;subdomain&apos;</span> =&gt; <span class="string">&apos;xxx&apos;</span>,</div><div class="line">        <span class="string">&apos;rport&apos;</span> =&gt; 0,</div><div class="line">        <span class="string">&apos;lhost&apos;</span> =&gt; <span class="string">&apos;127.0.0.1&apos;</span>,</div><div class="line">        <span class="string">&apos;lport&apos;</span> =&gt; 80</div><div class="line">    ),</div><div class="line">    array(</div><div class="line">        <span class="string">&apos;protocol&apos;</span> =&gt; <span class="string">&apos;tcp&apos;</span>,</div><div class="line">        <span class="string">&apos;hostname&apos;</span> =&gt; <span class="string">&apos;&apos;</span>,</div><div class="line">        <span class="string">&apos;subdomain&apos;</span> =&gt; <span class="string">&apos;&apos;</span>,</div><div class="line">        <span class="string">&apos;rport&apos;</span> =&gt; 57715,</div><div class="line">        <span class="string">&apos;lhost&apos;</span> =&gt; <span class="string">&apos;127.0.0.1&apos;</span>,</div><div class="line">        <span class="string">&apos;lport&apos;</span> =&gt; 22</div><div class="line">    ),</div><div class="line">);</div></pre></td></tr></table></figure></p>
<p>&#x76F4;&#x63A5;&#x8FD0;&#x884C;&#x5C31;&#x53EF;&#x4EE5;</p>
<p>&#x53EF;&#x4EE5;&#x6DFB;&#x52A0;&#x8BA1;&#x5212;shell&#x811A;&#x672C;&#x68C0;&#x6D4B;&#x662F;&#x5426;&#x8FD0;&#x884C;ngrok&#x5BA2;&#x6237;&#x7AEF;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[树莓派－利用owncloud搭建个人私有云]]></title>
      <url>http://www.hugospi.com/2016-07-29/raspberry-owncloud/</url>
      <content type="html"><![CDATA[<p>owncloud&#xFF1A;&#x7B80;&#x5355;&#x6765;&#x8BF4;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x57FA;&#x4E8E;PHP&#x7684;&#x7F51;&#x76D8;</p>
<p>&#x9700;&#x8981;&#x7684;&#x4F9D;&#x8D56;&#xFF1A;<br>MySQL&#x6570;&#x636E;&#x5E93;&#x3001;php&#x3001;&#x6570;&#x636E;&#x5E93;&#x9A71;&#x52A8;&#x3001;apache2&#x3001;curl</p>
<p>1.&#x5B89;&#x88C5;&#x4F9D;&#x8D56;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install apache2 php5 php5-gd php-xml-parser php5-intl php5-sqlite php5-mysql smbclient curl libcurl3 php5-curl mysql-server</div></pre></td></tr></table></figure></p>
<p>&#x5B89;&#x88C5;&#x8FC7;&#x7A0B;&#x4E2D;&#x4F1A;&#x63D0;&#x793A;&#x4F60;&#x8BBE;&#x7F6E;&#x6570;&#x636E;&#x5E93;&#x5BC6;&#x7801;&#xFF0C;&#x81EA;&#x5DF1;&#x8BBE;&#x7F6E;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;<br><a id="more"></a><br>2.&#x4E0B;&#x8F7D;&#x5B89;&#x88C5;owncloud<br>url&#xFF1A;<a href="https://owncloud.org/install/" rel="external nofollow noopener noreferrer" target="_blank">https://owncloud.org/install/</a><br>&#x6211;&#x5B89;&#x88C5;&#x7684;&#x662F;9.1&#x7248;&#x672C;</p>
<p>&#x914D;&#x7F6E;&#xFF1A;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> /var/www/html    <span class="comment">#&#x8FDB;&#x53BB;&#x7F51;&#x9875;&#x76EE;&#x5F55;</span></div><div class="line">tar jxvf owncloud-9.1.0.tar.bz2 -C  /var/www/html <span class="comment">#&#x89E3;&#x538B;</span></div><div class="line"><span class="built_in">cd</span> /var/www/html/owncloud</div><div class="line">sudo mkdir data</div><div class="line"></div><div class="line"><span class="comment">#&#x8BBE;&#x7F6E;&#x6743;&#x9650;&#xFF1A;</span></div><div class="line">sudo chown -R www-data:www-data data </div><div class="line">sudo chown -R www-data:www-data config </div><div class="line">sudo chown -R www-data:www-data apps</div></pre></td></tr></table></figure></p>
<p>&#x4FEE;&#x6539;&#x914D;&#x7F6E;/etc/apache2/apache2.conf  &#xFF08;&#x5907;&#x4EFD;&#xFF09;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#&#x4FEE;&#x6539;&#x4E4B;&#x540E;&#xFF1A;</span></div><div class="line">&lt;Directory /var/www/&gt;</div><div class="line">        Options Indexes FollowSymLinks</div><div class="line">        AllowOverride All</div><div class="line">        Require all granted</div><div class="line">&lt;/Directory&gt;</div></pre></td></tr></table></figure></p>
<p>&#x91CD;&#x65B0;&#x542F;&#x52A8;&#x4E0B;apache<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo service apache2 restart</div></pre></td></tr></table></figure></p>
<p>&#x8BBF;&#x95EE;<a href="http://&#x6811;&#x8393;&#x6D3E;ip/owncloud" rel="external nofollow noopener noreferrer" target="_blank">http://&#x6811;&#x8393;&#x6D3E;ip/owncloud</a>  </p>
<p>&#x53EF;&#x4EE5;&#x4E0B;&#x8F7D;&#x5BF9;&#x5E94;&#x7684;owncloud&#x8FDB;&#x884C;&#x4E91;&#x76D8;&#x7BA1;&#x7406;&#xFF0C;&#x5728;&#x624B;&#x673A;&#x4E0A;&#x4E5F;&#x5F88;&#x65B9;&#x4FBF;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[树莓派－用shairport-sync搭建airplay播放器]]></title>
      <url>http://www.hugospi.com/2016-07-27/raspberry-airplay/</url>
      <content type="html"><![CDATA[<p>shairport-sync<br>&#x4EE3;&#x7801;&#x5730;&#x5740;&#xFF1A;<a href="https://github.com/mikebrady/shairport-sync" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/mikebrady/shairport-sync</a></p>
<p>&#x7167;&#x7740;&#x4F5C;&#x8005;&#x8BF4;&#x660E;&#x6B65;&#x9AA4;&#x5F04;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;</p>
<p>1.&#x9996;&#x5148;&#x5B89;&#x88C5;&#x4F9D;&#x8D56;&#x8F6F;&#x4EF6;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install build-essential git</div><div class="line">sudo apt-get install autoconf automake libtool libdaemon-dev libasound2-dev libpopt-dev libconfig-dev</div><div class="line">sudo apt-get install avahi-daemon libavahi-client-dev</div><div class="line">sudo apt-get install apt-get install libssl-dev</div><div class="line">sudo apt-get install libpolarssl-dev</div><div class="line">sudo apt-get install libsoxr-dev</div></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x91CC;&#x6211;&#x5B89;&#x88C5;libasound2-dev &#x7684;&#x65F6;&#x5019;&#x63D0;&#x793A;&#x4F9D;&#x8D56;&#x6709;&#x95EE;&#x9898;&#xFF0C;&#x672C;&#x6587;&#x6700;&#x540E;&#x4F1A;&#x8BF4;&#x5230;<br><a id="more"></a><br>2.&#x4E0B;&#x8F7D;&#x7F16;&#x8BD1;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">git <span class="built_in">clone</span> https://github.com/mikebrady/shairport-sync.git</div><div class="line"><span class="built_in">cd</span> shairport-sync</div><div class="line">autoreconf -i <span class="_">-f</span></div><div class="line">sudo ./configure --with-alsa --with-avahi --with-ssl=openssl --with-metadata --with-soxr --with-systemd --with-systemdsystemunitdir=/lib/systemd/system</div><div class="line"></div><div class="line">make</div><div class="line">getent group shairport-sync &amp;&gt;/dev/null || sudo groupadd -r shairport-sync &gt;/dev/null</div><div class="line"></div><div class="line">getent passwd shairport-sync &amp;&gt; /dev/null || sudo useradd -r -M -g shairport-sync <span class="_">-s</span> /usr/bin/nologin -G audio shairport-sync &gt;/dev/null</div><div class="line"></div><div class="line">sudo make install</div><div class="line">sudo systemctl <span class="built_in">enable</span> shairport-sync</div><div class="line">sudo make install</div><div class="line">sudo cp scripts/shairport-sync /etc/init.d/</div><div class="line">sudo update-rc.d shairport-sync defaults 90 10</div></pre></td></tr></table></figure></p>
<p>3.&#x81EA;&#x5B9A;&#x4E49;<br>/etc/shairport-sync.conf  (&#x5907;&#x4EFD;&#x5907;&#x4EFD;)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">general =</div><div class="line">{</div><div class="line">    name = <span class="string">&quot;Front Room&quot;</span>;  <span class="comment">#&#x8BBE;&#x5907;&#x540D;&#x79F0;</span></div><div class="line">    password = <span class="string">&quot;secret&quot;</span>;</div><div class="line">    interpolation = <span class="string">&quot;soxr&quot;</span>;</div><div class="line">    // ... other general settings</div><div class="line">};</div><div class="line"></div><div class="line">alsa =</div><div class="line">{</div><div class="line">  output_device = <span class="string">&quot;hw:0,5&quot;</span>;  <span class="comment">#&#x8F93;&#x51FA;&#x8BBE;&#x5907;&#x7F16;&#x53F7;</span></div><div class="line">  mixer_device = <span class="string">&quot;hw:0&quot;</span>;</div><div class="line">  mixer_control_name = <span class="string">&quot;PCM&quot;</span>; &#xFF03;&#x97F3;&#x91CF;&#x63A7;&#x5236;&#x5668;&#x540D;&#x79F0;</div><div class="line">  // ... other alsa settings</div><div class="line">};</div></pre></td></tr></table></figure></p>
<p>&#x5176;&#x5B83;&#x53C2;&#x6570;&#x76F4;&#x63A5;&#x770B;&#x4F5C;&#x8005;&#x8BF4;&#x660E;</p>
<p>4.&#x542F;&#x52A8;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo /etc/init.d/shairport-sync start</div></pre></td></tr></table></figure></p>
<p>&#x5B89;&#x88C5;libasound2-dev&#x51FA;&#x73B0;&#x7684;&#x95EE;&#x9898;&#xFF1A;<br> &#x5B89;&#x88C5;&#x7684;&#x65F6;&#x5019;&#x8BF4;&#x60F3;&#x8981;libasound2&#xFF0C;&#x76F4;&#x63A5;apt-get&#x5B89;&#x88C5;&#x53C8;&#x6CA1;&#x6709;&#xFF0C;&#x53EA;&#x80FD;&#x91CD;&#x65B0;&#x5B89;&#x88C5;libasound2<br>sudo apt-get remove libasound2  &#x4E4B;&#x540E;&#x53C8;&#x63D0;&#x793A;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">The following packages have unmet dependencies:</div><div class="line"> openjdk-7-jdk : Depends: openjdk-7-jre (= 7u101-2.6.6-2~deb8u1+rpi1) but it is not going to be installed</div><div class="line">E: Error, pkgProblemResolver::Resolve generated breaks, this may be caused by held packages.</div></pre></td></tr></table></figure></p>
<p>&#x6700;&#x7EC8;&#x5B89;&#x88C5;&#x76F8;&#x5173;&#x4F9D;&#x8D56;&#x89E3;&#x51B3;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install openjdk-7-jdk openjdk-7-jre </div><div class="line">sudo apt-get install openjdk-8-jdk openjdk-8-jre </div><div class="line">sudo apt-get remove libasound2 </div><div class="line">sudo apt-get install libasound2-dev</div></pre></td></tr></table></figure></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[树莓派－切换usb声卡]]></title>
      <url>http://www.hugospi.com/2016-07-27/raspberry-auto/</url>
      <content type="html"><![CDATA[<p>&#x6811;&#x8393;&#x6D3E;&#x81EA;&#x5E26;&#x7684;3.5&#x58F0;&#x97F3;&#x63A5;&#x53E3;&#x7535;&#x6D41;&#x58F0;&#x611F;&#x4EBA;&#xFF0C;&#x6DD8;&#x5B9D;&#x4E70;&#x4E86;&#x4E00;&#x4E2A;usb&#x514D;&#x9A71;&#x58F0;&#x5361;</p>
<p>&#x8FD9;&#x91CC;&#x7EAA;&#x5F55;&#x4E0B;raspbian 4.4&#x7CFB;&#x7EDF;&#x5207;&#x6362;&#x58F0;&#x5361;&#x7684;&#x65B9;&#x6CD5;</p>
<p>&#x67E5;&#x770B;&#x58F0;&#x5361;&#xFF1A;cat /proc/asound/cards<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">0 [ALSA           ]: bcm2835 - bcm2835 ALSA</div><div class="line">                     bcm2835 ALSA</div><div class="line">1 [Device         ]: USB-Audio - USB PnP Sound Device</div><div class="line">                     C-Media Electronics Inc. USB PnP Sound Device at usb-3f980000.usb-1.5.3, full s</div></pre></td></tr></table></figure></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x4E24;&#x5F20;&#x58F0;&#x5361;&#xFF0C;usb-Audio&#x5C31;&#x662F;usb&#x58F0;&#x5361; </p>
<p>&#x7F16;&#x8F91;&#x5BB6;&#x76EE;&#x5F55;&#x4E0B;&#x7684; .asoundrc&#x6587;&#x4EF6;&#xFF0C;&#x5C06;0&#x6539;&#x4E3A;1&#xFF0C;&#x4FEE;&#x6539;&#x540E;&#x5982;&#x4E0B;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">pcm.!default {</div><div class="line">         <span class="built_in">type</span> hw</div><div class="line">         card 1</div><div class="line"> } </div><div class="line"> ctl.!default {</div><div class="line">         <span class="built_in">type</span> hw</div><div class="line">         card 1</div><div class="line"> }</div></pre></td></tr></table></figure></p>
<p>&#x521B;&#x5EFA;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF1A;/etc/asound.conf<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">pcm.!default {</div><div class="line">    <span class="built_in">type</span> hw</div><div class="line">    card 1</div><div class="line">}</div><div class="line"></div><div class="line">ctl.!default {</div><div class="line">    <span class="built_in">type</span> hw</div><div class="line">    card 1</div><div class="line">}</div></pre></td></tr></table></figure></p>
<p>&#x901A;&#x8FC7;alsamixer&#x547D;&#x4EE4;&#x53EF;&#x4EE5;&#x8C03;&#x8282;&#x97F3;&#x91CF;`</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[树莓派－搭建家庭nas服务]]></title>
      <url>http://www.hugospi.com/2016-07-27/raspberry-samba/</url>
      <content type="html"><![CDATA[<p>1.&#x51C6;&#x5907;&#x786C;&#x76D8;<br>ps:&#xFF08;&#x786C;&#x76D8;&#x6700;&#x597D;&#x7528;&#x5E26;&#x7535;&#x6E90;&#x7684;hub&#x8FDE;&#x63A5;&#xFF0C;&#x4E0D;&#x7136;&#x6811;&#x8393;&#x6D3E;&#x6709;&#x53EF;&#x80FD;&#x4F1A;&#x2026;&#xFF09;<br>&#x8FD9;&#x91CC;&#x9009;&#x62E9;&#x5C06;&#x786C;&#x76D8;&#x683C;&#x5F0F;&#x5316;&#x4E3A;ext4<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#&#x67E5;&#x770B;&#x786C;&#x76D8;</span></div><div class="line">sudo fdisk <span class="_">-l</span></div><div class="line"><span class="comment">#&#x5378;&#x8F7D;&#x786C;&#x76D8;</span></div><div class="line">sudo umount /dev/sda1</div><div class="line"><span class="comment">#&#x683C;&#x5F0F;&#x5316;</span></div><div class="line">sudo mkfs.ext4 /dev/sda1</div></pre></td></tr></table></figure></p>
<a id="more"></a>
<p>2.&#x6302;&#x8F7D;&#x786C;&#x76D8;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#&#x65B0;&#x5EFA;&#x6302;&#x8F7D;&#x76EE;&#x5F55;</span></div><div class="line">mkdir /home/pi/NAS</div><div class="line"><span class="comment">#&#x6302;&#x8F7D;&#x786C;&#x76D8;</span></div><div class="line">sudo mount /dev/sda1 /home/pi/NAS</div><div class="line"><span class="comment">#&#x8BBE;&#x7F6E;&#x6743;&#x9650;</span></div><div class="line">sudo chown pi:pi /home/pi/NAS</div></pre></td></tr></table></figure></p>
<p>3.&#x5B89;&#x88C5;&#x914D;&#x7F6E;samba<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install samba samba-common-bin</div></pre></td></tr></table></figure></p>
<p>&#x7F16;&#x8F91;&#x914D;&#x7F6E;&#x6587;&#x4EF6; sudo vi /etc/samba/smb.conf  (&#x5907;&#x4EFD;&#x6587;&#x4EF6;&#x662F;&#x4E2A;&#x597D;&#x4E60;&#x60EF;)<br>&#x6DFB;&#x52A0;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[share]</div><div class="line">    path = /home/pi/NAS  <span class="comment">#&#x5171;&#x4EAB;&#x8DEF;&#x5F84;</span></div><div class="line">    browseable = yes</div><div class="line">    writable = yes</div><div class="line">    create mask = 0664  <span class="comment">#&#x65B0;&#x5EFA;&#x6587;&#x4EF6;&#x6743;&#x9650;</span></div><div class="line">    directory mask = 0775  <span class="comment">#&#x65B0;&#x5EFA;&#x76EE;&#x5F55;&#x6743;&#x9650;</span></div></pre></td></tr></table></figure></p>
<p>&#x8BBE;&#x7F6E;&#x5171;&#x4EAB;&#x7528;&#x6237;&#x5BC6;&#x7801;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo smbpasswd <span class="_">-a</span> pi</div></pre></td></tr></table></figure></p>
<p>&#x8F93;&#x5165;&#x5BC6;&#x7801;<br>&#x91CD;&#x65B0;&#x542F;&#x52A8;samba&#x670D;&#x52A1;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo /etc/init.d/samba restart</div></pre></td></tr></table></figure></p>
<p>&#x8BBF;&#x95EE;&#x65B9;&#x6CD5;&#xFF1A;<br>windows&#x7528;&#x6237;&#x6309;win&#xFF0B;r&#x8C03;&#x51FA;&#x7A97;&#x53E3;&#x8F93;&#x5165; \\&#x6811;&#x8393;&#x6D3E;ip<br>mac&#x7528;&#x6237;&#x8FDE;&#x63A5;&#x670D;&#x52A1;&#x5668; smb://&#x6811;&#x8393;&#x6D3E;ip</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[树莓派－配置使用国内就像软件源更新]]></title>
      <url>http://www.hugospi.com/2016-07-27/raspberry-update/</url>
      <content type="html"><![CDATA[<p>&#x73AF;&#x5883;&#xFF1A;&#x6811;&#x8393;&#x6D3E;3 &#x7CFB;&#x7EDF;raspbian jessie&#x7248;</p>
<p>&#x4FEE;&#x6539;&#x66F4;&#x65B0;&#x6E90;&#x6587;&#x4EF6;&#xFF0C;&#x4FEE;&#x6539;&#x4E4B;&#x524D;&#x8BB0;&#x5F97;&#x5907;&#x4EFD;&#x6587;&#x4EF6;<br>1.&#x4FEE;&#x6539; sources.list<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo vi /etc/apt/sources.list</div></pre></td></tr></table></figure></p>
<p>&#x5220;&#x9664;&#x539F;&#x6765;&#x7684;&#x6240;&#x6709;&#x5185;&#x5BB9;&#x66FF;&#x6362;&#x4E3A;&#x56FD;&#x5185;&#x6E90;&#xFF0C;&#x8FD9;&#x91CC;&#x4F7F;&#x7528;&#x7684;&#x662F;&#x6D59;&#x6C5F;&#x5927;&#x5B66;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">deb http://mirrors.zju.edu.cn/raspbian/raspbian/ jessie main contrib non-free rpi</div><div class="line">deb-src http://mirrors.zju.edu.cn/raspbian/raspbian/ jessie main contrib non-free rpi</div></pre></td></tr></table></figure></p>
<p>2.&#x4FEE;&#x6539;/etc/apt/sources.list.d/raspi.list &#x6E05;&#x534E;&#x5927;&#x5B66;&#x7684;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">deb http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ jessie main non-free contrib</div><div class="line">deb-src http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ jessie main non-free contrib</div></pre></td></tr></table></figure></p>
<p>&#x6700;&#x540E;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get update</div></pre></td></tr></table></figure></p>
<p>&#x66F4;&#x591A;&#x955C;&#x50CF;&#x6E90;:<a href="http://www.raspbian.org/RaspbianMirrors" rel="external nofollow noopener noreferrer" target="_blank">http://www.raspbian.org/RaspbianMirrors</a></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[树莓派－编译安装新版本的python]]></title>
      <url>http://www.hugospi.com/2016-07-27/raspberry-python/</url>
      <content type="html"><![CDATA[<p>&#x6211;&#x7684;&#x6811;&#x8393;&#x6D3E;&#x4E0A;&#x9762;&#x9884;&#x88C5;&#x7684;python&#x7248;&#x672C;&#x662F;3.4.2,&#x5B98;&#x7F51;&#x6700;&#x65B0;&#x7248;&#x672C;&#x4E3A;3.6<br>url&#xFF1A;<a href="https://www.python.org/ftp/python/3.6.0/Python-3.6.0a3.tgz" rel="external nofollow noopener noreferrer" target="_blank">https://www.python.org/ftp/python/3.6.0/Python-3.6.0a3.tgz</a></p>
<p>1.&#x5B89;&#x88C5;python &#x9700;&#x8981;&#x7684;&#x4F9D;&#x8D56;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install build-essential libsqlite3-dev sqlite3 bzip2 libbz2-dev libssl-dev openssl libgdbm-dev liblzma-dev libreadline-dev libncursesw5-dev</div></pre></td></tr></table></figure></p>
<p>2.&#x4E0B;&#x8F7D;&#x89E3;&#x538B;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">wget https://www.python.org/ftp/python/3.6.0/Python-3.6.0a3.tgz </div><div class="line">tar zxvf Python-3.6.0a3.tgz</div></pre></td></tr></table></figure></p>
<p>3.&#x7F16;&#x8BD1;&#x5B89;&#x88C5;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> ./Python-3.6.0a3</div><div class="line">./configure --prefix=/opt/python3.6</div><div class="line">make</div><div class="line">make</div><div class="line">sudo make install</div></pre></td></tr></table></figure></p>
<p>&#x521B;&#x5EFA;&#x8F6F;&#x94FE;&#x63A5;,&#x521B;&#x5EFA;&#x4E4B;&#x540E;&#xFF0C;&#x6253;python3&#x5C31;&#x80FD;&#x542F;&#x52A8;python 3.6&#x4E86;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo rm /usr/bin/python3</div><div class="line">sudo ln <span class="_">-s</span> /opt/python3.6/bin/python3.6   /usr/bin/python3</div></pre></td></tr></table></figure></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[树莓派－替换更新raspbian系统vim]]></title>
      <url>http://www.hugospi.com/2016-07-27/raspberryvim/</url>
      <content type="html"><![CDATA[<p>&#x6811;&#x8393;&#x6D3E;&#x81EA;&#x5E26;&#x7684;vi&#x7F16;&#x8F91;&#x5668;&#x592A;&#x96BE;&#x7528;&#x4E86;&#xFF0C;&#x4E0B;&#x9762;&#x7EAA;&#x5F55;&#x66F4;&#x65B0;raspbian&#x7CFB;&#x7EDF;vi&#x7684;&#x66F4;&#x65B0;</p>
<p>1.&#x5220;&#x9664;&#x7CFB;&#x7EDF;&#x539F;&#x6765;&#x7684;vi&#x7F16;&#x8F91;&#x5668;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get remove vim-common</div></pre></td></tr></table></figure></p>
<p>2.&#x5B89;&#x88C5;&#x65B0;&#x7684;vi<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install vim</div></pre></td></tr></table></figure></p>
<p>3.&#x81EA;&#x5B9A;&#x4E49;vi<br>&#x7F16;&#x8F91;/etc/vim/vimrc&#x6587;&#x4EF6;&#xFF0C;&#x6DFB;&#x52A0;&#x4EE5;&#x4E0B;&#x5185;&#x5BB9;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#&#x663E;&#x793A;&#x884C;&#x53F7;</span></div><div class="line"><span class="built_in">set</span> nu</div><div class="line"><span class="comment">#&#x8BED;&#x6CD5;&#x9AD8;&#x4EAE;</span></div><div class="line">syntax on </div><div class="line"><span class="comment">#tab &#x9000;&#x56DB;&#x683C;</span></div><div class="line"><span class="built_in">set</span> tabstop=4</div></pre></td></tr></table></figure>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[树莓派－mac系统下安装raspbian系统到sd卡]]></title>
      <url>http://www.hugospi.com/2016-07-26/raspberry-mac/</url>
      <content type="html"><![CDATA[<p>1.&#x9996;&#x5148;&#x5B98;&#x7F51;&#x4E0B;&#x8F7D;&#x7CFB;&#x7EDF;<br>url&#xFF1A;<a href="https://www.raspberrypi.org/downloads/raspbian/" rel="external nofollow noopener noreferrer" target="_blank">https://www.raspberrypi.org/downloads/raspbian/</a></p>
<p>&#x63D2;&#x5165;sd&#x5361;&#xFF0C;&#x67E5;&#x770B;&#x6302;&#x8F7D;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">df -h</div></pre></td></tr></table></figure></p>
<p>SD&#x8BBE;&#x5907;&#x6587;&#x4EF6;&#x4E3A;&#xFF1A;/dev/disk2s1<br>&#x4F7F;&#x7528;diskutil unmount&#x5378;&#x8F7D;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">diskutil unmount /dev/disk2s1</div></pre></td></tr></table></figure></p>
<p>2.&#x5B89;&#x88C5;&#x7CFB;&#x7EDF;<br>&#x4F7F;&#x7528;dd&#x547D;&#x4EE4;&#x5C06;&#x7CFB;&#x7EDF;&#x955C;&#x50CF;&#x5199;&#x5165;<br>PS /dev/disk2s1&#x662F;&#x5206;&#x533A;&#xFF0C;/dev/disk2&#x662F;&#x5757;&#x8BBE;&#x5907;&#xFF0C;/dev/rdisk2&#x662F;&#x539F;&#x59CB;&#x5B57;&#x7B26;&#x8BBE;&#x5907;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#&#x9996;&#x5148;&#x8FDB;&#x5165;&#x955C;&#x50CF;&#x76EE;&#x5F55;&#x6216;&#x76F4;&#x63A5;&#x4E0B;&#x8DEF;&#x5F84;</span></div><div class="line">dd bs=4m <span class="keyword">if</span>=pi.img of=/dev/rdisk2</div></pre></td></tr></table></figure></p>
<p>&#x81F3;&#x6B64;&#xFF0C;SD&#x5361;&#x4E0A;&#x5DF2;&#x7ECF;&#x5237;&#x5165;&#x4E86; Raspbian &#x7CFB;&#x7EDF;</p>
<p>&#x518D;&#x7528;diskutil unmountDisk&#x5378;&#x8F7D;&#x8BBE;&#x5907;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">diskutil unmountDisk /dev/disk2</div></pre></td></tr></table></figure></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[树莓派－树莓派sd卡系统备份还原]]></title>
      <url>http://www.hugospi.com/2016-07-23/raspberrybak/</url>
      <content type="html"><![CDATA[<p>&#x51FA;&#x4E8E;&#x5BF9;sd&#x5361;&#x7684;&#x4E0D;&#x4FE1;&#x4EFB;&#xFF0C;&#x6307;&#x4E0D;&#x5B9A;&#x54EA;&#x4E00;&#x5929;sd&#x5361;&#x7A81;&#x7136;&#x6B7B;&#x6389;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x8BB0;&#x5F55;&#x4E0B;&#x6811;&#x8393;&#x6D3E;&#x7CFB;&#x7EDF;&#x7684;&#x529E;&#x6CD5;<br>&#x65B9;&#x6CD5;&#x4E00;&#xFF1A;<br>&#x811A;&#x672C;&#x5730;&#x5740;&#xFF1A;<a href="https://www.raspberrypi.org/forums/viewtopic.php?p=635962#p635962" rel="external nofollow noopener noreferrer" target="_blank">https://www.raspberrypi.org/forums/viewtopic.php?p=635962#p635962</a>  &#x7248;&#x6743;&#x5F52;&#x539F;&#x4F5C;&#x8005;&#x6240;&#x6709;</p>
<p>&#x53EF;&#x914D;&#x5408;crontab&#x5B9A;&#x65F6;&#x5907;&#x4EFD;&#x7CFB;&#x7EDF;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo touch bkup_rpimage.sh</div><div class="line">sudo nano bkup_rpimage.sh</div></pre></td></tr></table></figure></p>
<a id="more"></a>
<p>&#x811A;&#x672C;:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line"># bkup_rpimage.sh by jinx</div><div class="line">#</div><div class="line"># Utility script to backup Raspberry Pi&apos;s SD Card to a sparse image file</div><div class="line"># mounted as a filesystem in a file, allowing for efficient incremental</div><div class="line"># backups using rsync</div><div class="line"></div><div class="line">VERSION=v1.0</div><div class="line">SDCARD=/dev/mmcblk0</div><div class="line"></div><div class="line"># Echos traces with yellow text to distinguish from other output</div><div class="line">trace () {</div><div class="line">    echo -e &quot;$(tput setaf 3)${1}$(tput sgr 0)&quot;</div><div class="line">}</div><div class="line"></div><div class="line"># Echos en error string in red text and exit</div><div class="line">error () {</div><div class="line">    echo -e &quot;$(tput setaf 1)${1}$(tput sgr 0)&quot; &gt;&amp;2</div><div class="line">    exit 1</div><div class="line">}</div><div class="line"></div><div class="line"># Creates a sparse $IMAGE clone of $SDCARD and attaches to $LOOPBACK</div><div class="line">    do_create () {</div><div class="line">        trace &quot;Creating sparse $IMAGE, the apparent size of $SDCARD&quot;</div><div class="line">        dd if=/dev/zero of=$IMAGE bs=$(blockdev --getss $SDCARD) count=0 seek=$(blockdev --getsz $SDCARD)</div><div class="line"></div><div class="line">    if [ -s $IMAGE ]; then</div><div class="line">            trace &quot;Attaching $IMAGE to $LOOPBACK&quot;</div><div class="line">            losetup $LOOPBACK $IMAGE</div><div class="line">        else</div><div class="line">            error &quot;$IMAGE was not created or has zero size&quot;</div><div class="line">    fi</div><div class="line"></div><div class="line">    trace &quot;Copying partition table from $SDCARD to $LOOPBACK&quot;</div><div class="line">    parted -s $LOOPBACK mklabel msdos</div><div class="line">        sfdisk --dump $SDCARD | sfdisk --force $LOOPBACK</div><div class="line"></div><div class="line">    trace &quot;Formatting partitions&quot;</div><div class="line">    partx --add $LOOPBACK</div><div class="line">        mkfs.vfat -I $LOOPBACK1</div><div class="line">    mkfs.ext4 $LOOPBACK2</div><div class="line">}</div><div class="line"></div><div class="line"># Mounts the $IMAGE to $LOOPBACK (if needed) and $MOUNTDIR</div><div class="line">    do_mount () {</div><div class="line">        # Check if do_create already attached the SD Image</div><div class="line">        if [ $(losetup -f) = $LOOPBACK ]; then</div><div class="line">            trace &quot;Attaching $IMAGE to $LOOPBACK&quot;</div><div class="line">            losetup $LOOPBACK $IMAGE</div><div class="line">            partx --add $LOOPBACK</div><div class="line">    fi</div><div class="line"></div><div class="line">    trace &quot;Mounting $LOOPBACK1 and $LOOPBACK2 to $MOUNTDIR&quot;</div><div class="line">        if [ ! -n &quot;$opt_mountdir&quot; ]; then</div><div class="line">        mkdir $MOUNTDIR</div><div class="line">        fi</div><div class="line">        mount $LOOPBACK2 $MOUNTDIR</div><div class="line">        mkdir -p $MOUNTDIR/boot</div><div class="line">    mount $LOOPBACK1 $MOUNTDIR/boot</div><div class="line">}</div><div class="line"></div><div class="line"># Rsyncs content of $SDCARD to $IMAGE if properly mounted</div><div class="line">do_backup () {</div><div class="line">    if mountpoint -q $MOUNTDIR; then</div><div class="line">            trace &quot;Starting rsync backup of / and /boot/ to $MOUNTDIR&quot;</div><div class="line">        if [ -n &quot;$opt_log&quot; ]; then</div><div class="line">                rsync -aEvx --del --stats --log-file $LOG /boot/ $MOUNTDIR/boot/</div><div class="line">                rsync -aEvx --del --stats --log-file $LOG / $MOUNTDIR/</div><div class="line">            else</div><div class="line">                rsync -aEvx --del --stats /boot/ $MOUNTDIR/boot/</div><div class="line">            rsync -aEvx --del --stats / $MOUNTDIR/</div><div class="line">            fi</div><div class="line">        else</div><div class="line">            trace &quot;Skipping rsync since $MOUNTDIR is not a mount point&quot;</div><div class="line">    fi</div><div class="line">}</div><div class="line"></div><div class="line"># Unmounts the $IMAGE from $MOUNTDIR and $LOOPBACK</div><div class="line">do_umount () {</div><div class="line">    trace &quot;Flushing to disk&quot;</div><div class="line">    sync; sync</div><div class="line"></div><div class="line">    trace &quot;Unmounting $LOOPBACK1 and $LOOPBACK2 from $MOUNTDIR&quot;</div><div class="line">        umount $MOUNTDIR/boot</div><div class="line">    umount $MOUNTDIR</div><div class="line">        if [ ! -n &quot;$opt_mountdir&quot; ]; then</div><div class="line">        rmdir $MOUNTDIR</div><div class="line">    fi</div><div class="line"></div><div class="line">    trace &quot;Detaching $IMAGE from $LOOPBACK&quot;</div><div class="line">    partx --delete $LOOPBACK</div><div class="line">        losetup -d $LOOPBACK</div><div class="line">}</div><div class="line"></div><div class="line"># Compresses $IMAGE to $IMAGE.gz using a temp file during compression</div><div class="line">do_compress () {</div><div class="line">    trace &quot;Compressing $IMAGE to ${IMAGE}.gz&quot;</div><div class="line">    pv -tpreb $IMAGE | gzip &gt; ${IMAGE}.gz.tmp</div><div class="line">    if [ -s ${IMAGE}.gz.tmp ]; then</div><div class="line">            mv -f ${IMAGE}.gz.tmp ${IMAGE}.gz</div><div class="line">            if [ -n &quot;$opt_delete&quot; ]; then</div><div class="line">            rm -f $IMAGE</div><div class="line">        fi</div><div class="line">    fi</div><div class="line">}</div><div class="line"></div><div class="line"># Tries to cleanup after Ctrl-C interrupt</div><div class="line">ctrl_c () {</div><div class="line">    trace &quot;Ctrl-C detected.&quot;</div><div class="line"></div><div class="line">    if [ -s ${IMAGE}.gz.tmp ]; then</div><div class="line">            rm ${IMAGE}.gz.tmp</div><div class="line">    else</div><div class="line">        do_umount</div><div class="line">    fi</div><div class="line"></div><div class="line">    if [ -n &quot;$opt_log&quot; ]; then</div><div class="line">            trace &quot;See rsync log in $LOG&quot;</div><div class="line">    fi</div><div class="line"></div><div class="line">    error &quot;SD Image backup process interrupted&quot;</div><div class="line">}</div><div class="line"></div><div class="line"># Prints usage information</div><div class="line">usage () {</div><div class="line">    echo -e &quot;&quot;</div><div class="line">    echo -e &quot;$(basename $0) $VERSION by jinx&quot;</div><div class="line">        echo -e &quot;&quot;</div><div class="line">        echo -e &quot;Usage:&quot;</div><div class="line">        echo -e &quot;&quot;</div><div class="line">        echo -e &quot;    $(basename $0) $(tput bold)start$(tput sgr 0) [-clzdf] [-L logfile] [-i sdcard] sdimage&quot;</div><div class="line">        echo -e &quot;    $(basename $0) $(tput bold)mount$(tput sgr 0) [-c] sdimage [mountdir]&quot;</div><div class="line">        echo -e &quot;    $(basename $0) $(tput bold)umount$(tput sgr 0) sdimage [mountdir]&quot;</div><div class="line">        echo -e &quot;    $(basename $0) $(tput bold)gzip$(tput sgr 0) [-df] sdimage&quot;</div><div class="line">        echo -e &quot;&quot;</div><div class="line">        echo -e &quot;    Commands:&quot;</div><div class="line">        echo -e &quot;&quot;</div><div class="line">        echo -e &quot;        $(tput bold)start$(tput sgr 0)  starts complete backup of RPi&apos;s SD Card to &apos;sdimage&apos;&quot;</div><div class="line">        echo -e &quot;        $(tput bold)mount$(tput sgr 0)  mounts the &apos;sdimage&apos; to &apos;mountdir&apos; (default: /mnt/&apos;sdimage&apos;/)&quot;</div><div class="line">        echo -e &quot;        $(tput bold)umount$(tput sgr 0) unmounts the &apos;sdimage&apos; from &apos;mountdir&apos;&quot;</div><div class="line">        echo -e &quot;        $(tput bold)gzip$(tput sgr 0)   compresses the &apos;sdimage&apos; to &apos;sdimage&apos;.gz&quot;</div><div class="line">        echo -e &quot;&quot;</div><div class="line">        echo -e &quot;    Options:&quot;</div><div class="line">        echo -e &quot;&quot;</div><div class="line">        echo -e &quot;        $(tput bold)-c$(tput sgr 0)         creates the SD Image if it does not exist&quot;</div><div class="line">        echo -e &quot;        $(tput bold)-l$(tput sgr 0)         writes rsync log to &apos;sdimage&apos;-YYYYmmddHHMMSS.log&quot;</div><div class="line">        echo -e &quot;        $(tput bold)-z$(tput sgr 0)         compresses the SD Image (after backup) to &apos;sdimage&apos;.gz&quot;</div><div class="line">        echo -e &quot;        $(tput bold)-d$(tput sgr 0)         deletes the SD Image after successful compression&quot;</div><div class="line">        echo -e &quot;        $(tput bold)-f$(tput sgr 0)         forces overwrite of &apos;sdimage&apos;.gz if it exists&quot;</div><div class="line">        echo -e &quot;        $(tput bold)-L logfile$(tput sgr 0) writes rsync log to &apos;logfile&apos;&quot;</div><div class="line">        echo -e &quot;        $(tput bold)-i sdcard$(tput sgr 0)  specifies the SD Card location (default: $SDCARD)&quot;</div><div class="line">    echo -e &quot;&quot;</div><div class="line">    echo -e &quot;Examples:&quot;</div><div class="line">    echo -e &quot;&quot;</div><div class="line">    echo -e &quot;    $(basename $0) rsync -c /path/to/rpi_backup.img&quot;</div><div class="line">    echo -e &quot;        starts backup to &apos;rpi_backup.img&apos;, creating it if it does not exist&quot;</div><div class="line">    echo -e &quot;&quot;</div><div class="line">    echo -e &quot;    $(basename $0) rsync /path/to/\$(uname -n).img&quot;</div><div class="line">    echo -e &quot;        uses the RPi&apos;s hostname as the SD Image filename&quot;</div><div class="line">    echo -e &quot;&quot;</div><div class="line">    echo -e &quot;    $(basename $0) rsync -cz /path/to/\$(uname -n)-\$(date +%Y-%m-%d).img&quot;</div><div class="line">    echo -e &quot;        uses the RPi&apos;s hostname and today&apos;s date as the SD Image filename,&quot;</div><div class="line">    echo -e &quot;        creating it if it does not exist, and compressing it after backup&quot;</div><div class="line">    echo -e &quot;&quot;</div><div class="line">    echo -e &quot;    $(basename $0) mount /path/to/\$(uname -n).img /mnt/rpi_image&quot;</div><div class="line">    echo -e &quot;        mounts the RPi&apos;s SD Image in /mnt/rpi_image&quot;</div><div class="line">    echo -e &quot;&quot;</div><div class="line">    echo -e &quot;    $(basename $0) umount /path/to/raspi-$(date +%Y-%m-%d).img&quot;</div><div class="line">        echo -e &quot;        unmounts the SD Image from default mountdir (/mnt/raspi-$(date +%Y-%m-%d).img/)&quot;</div><div class="line">    echo -e &quot;&quot;</div><div class="line">}</div><div class="line"></div><div class="line"># Read the command from command line</div><div class="line">case $1 in</div><div class="line">        start|mount|umount|gzip)</div><div class="line">            opt_command=$1</div><div class="line">        ;;</div><div class="line">    -h|--help)</div><div class="line">        usage</div><div class="line">        exit 0</div><div class="line">        ;;</div><div class="line">    --version)</div><div class="line">        trace &quot;$(basename $0) $VERSION by jinx&quot;</div><div class="line">            exit 0</div><div class="line">            ;;</div><div class="line">        *)</div><div class="line">            error &quot;Invalid command or option: $1\nSee &apos;$(basename $0) --help&apos; for usage&quot;;;</div><div class="line">esac</div><div class="line">shift 1</div><div class="line"></div><div class="line"># Make sure we have root rights</div><div class="line">if [ $(id -u) -ne 0 ]; then</div><div class="line">    error &quot;Please run as root. Try sudo.&quot;</div><div class="line">fi</div><div class="line"></div><div class="line"># Read the options from command line</div><div class="line">while getopts &quot;:czdflL:i:&quot; opt; do</div><div class="line">    case $opt in</div><div class="line">            c)  opt_create=1;;</div><div class="line">            z)  opt_compress=1;;</div><div class="line">            d)  opt_delete=1;;</div><div class="line">            f)  opt_force=1;;</div><div class="line">            l)  opt_log=1;;</div><div class="line">            L)  opt_log=1</div><div class="line">                LOG=$OPTARG</div><div class="line">            ;;</div><div class="line">        i)  SDCARD=$OPTARG;;</div><div class="line">            \?) error &quot;Invalid option: -$OPTARG\nSee &apos;$(basename $0) --help&apos; for usage&quot;;;</div><div class="line">        :)  error &quot;Option -$OPTARG requires an argument\nSee &apos;$(basename $0) --help&apos; for usage&quot;;;</div><div class="line">        esac</div><div class="line">    done</div><div class="line">    shift $((OPTIND-1))</div><div class="line"></div><div class="line"># Read the sdimage path from command line</div><div class="line">IMAGE=$1</div><div class="line">    if [ -z $IMAGE ]; then</div><div class="line">    error &quot;No sdimage specified&quot;</div><div class="line">fi</div><div class="line"></div><div class="line"># Check if sdimage exists</div><div class="line">if [ $opt_command = umount ] || [ $opt_command = gzip ]; then</div><div class="line">    if [ ! -f $IMAGE ]; then</div><div class="line">            error &quot;$IMAGE does not exist&quot;</div><div class="line">    fi</div><div class="line">else</div><div class="line">    if [ ! -f $IMAGE ] &amp;&amp; [ ! -n &quot;$opt_create&quot; ]; then</div><div class="line">        error &quot;$IMAGE does not exist\nUse -c to allow creation&quot;</div><div class="line">    fi</div><div class="line">fi</div><div class="line"></div><div class="line"># Check if we should compress and sdimage.gz exists</div><div class="line">if [ -n &quot;$opt_compress&quot; ] || [ $opt_command = gzip ]; then</div><div class="line">    if [ -s ${IMAGE}.gz ] &amp;&amp; [ ! -n &quot;$opt_force&quot; ]; then</div><div class="line">        error &quot;${IMAGE}.gz already exists\nUse -f to force overwriting&quot;</div><div class="line">    fi</div><div class="line">fi</div><div class="line"></div><div class="line"># Define default rsync logfile if not defined</div><div class="line">if [ -z $LOG ]; then</div><div class="line">        LOG=${IMAGE}-$(date +%Y%m%d%H%M%S).log</div><div class="line">fi</div><div class="line"></div><div class="line"># Identify which loopback device to use</div><div class="line">LOOPBACK=$(losetup -j $IMAGE | grep -o ^[^:]*)</div><div class="line">if [ $opt_command = umount ]; then</div><div class="line">        if [ -z $LOOPBACK ]; then</div><div class="line">        error &quot;No /dev/loop&lt;X&gt; attached to $IMAGE&quot;</div><div class="line">        fi</div><div class="line">    elif [ ! -z $LOOPBACK ]; then</div><div class="line">    error &quot;$IMAGE already attached to $LOOPBACK mounted on $(grep ${LOOPBACK}p2 /etc/mtab | cut -d &apos; &apos; -f 2)/&quot;</div><div class="line">else</div><div class="line">    LOOPBACK=$(losetup -f)</div><div class="line">    fi</div><div class="line">    LOOPBACK1=${LOOPBACK}p1</div><div class="line">LOOPBACK2=${LOOPBACK}p2</div><div class="line"></div><div class="line"># Read the optional mountdir from command line</div><div class="line">MOUNTDIR=$2</div><div class="line">    if [ -z $MOUNTDIR ]; then</div><div class="line">    MOUNTDIR=/mnt/$(basename $IMAGE)/</div><div class="line">else</div><div class="line">    opt_mountdir=1</div><div class="line">    if [ ! -d $MOUNTDIR ]; then</div><div class="line">            error &quot;Mount point $MOUNTDIR does not exist&quot;</div><div class="line">    fi</div><div class="line">fi</div><div class="line"></div><div class="line"># Check if default mount point exists</div><div class="line">if [ $opt_command = umount ]; then</div><div class="line">        if [ ! -d $MOUNTDIR ]; then</div><div class="line">        error &quot;Default mount point $MOUNTDIR does not exist&quot;</div><div class="line">        fi</div><div class="line">    else</div><div class="line">        if [ ! -n &quot;$opt_mountdir&quot; ] &amp;&amp; [ -d $MOUNTDIR ]; then</div><div class="line">            error &quot;Default mount point $MOUNTDIR already exists&quot;</div><div class="line">    fi</div><div class="line">fi</div><div class="line"></div><div class="line"># Trap keyboard interrupt (ctrl-c)</div><div class="line">trap ctrl_c SIGINT</div><div class="line"></div><div class="line"># Check for dependencies</div><div class="line">for c in dd losetup parted sfdisk partx mkfs.vfat mkfs.ext4 mountpoint rsync; do</div><div class="line">    command -v $c &gt;/dev/null 2&gt;&amp;1 || error &quot;Required program $c is not installed&quot;</div><div class="line">done</div><div class="line">if [ -n &quot;$opt_compress&quot; ] || [ $opt_command = gzip ]; then</div><div class="line">    for c in pv gzip; do</div><div class="line">        command -v $c &gt;/dev/null 2&gt;&amp;1 || error &quot;Required program $c is not installed&quot;</div><div class="line">    done</div><div class="line">fi</div><div class="line"></div><div class="line"># Do the requested functionality</div><div class="line">case $opt_command in</div><div class="line">        start)</div><div class="line">                trace &quot;Starting SD Image backup process&quot;</div><div class="line">                if [ ! -f $IMAGE ] &amp;&amp; [ -n &quot;$opt_create&quot; ]; then</div><div class="line">                    do_create</div><div class="line">                fi</div><div class="line">                do_mount</div><div class="line">                do_backup</div><div class="line">                do_umount</div><div class="line">                if [ -n &quot;$opt_compress&quot; ]; then</div><div class="line">                do_compress</div><div class="line">            fi</div><div class="line">            trace &quot;SD Image backup process completed.&quot;</div><div class="line">            if [ -n &quot;$opt_log&quot; ]; then</div><div class="line">                    trace &quot;See rsync log in $LOG&quot;</div><div class="line">            fi</div><div class="line">            ;;</div><div class="line">    mount)</div><div class="line">            if [ ! -f $IMAGE ] &amp;&amp; [ -n &quot;$opt_create&quot; ]; then</div><div class="line">                do_create</div><div class="line">            fi</div><div class="line">            do_mount</div><div class="line">            trace &quot;SD Image has been mounted and can be accessed at:\n    $MOUNTDIR&quot;</div><div class="line">                ;;</div><div class="line">        umount)</div><div class="line">                do_umount</div><div class="line">                ;;</div><div class="line">        gzip)</div><div class="line">                do_compress</div><div class="line">                ;;</div><div class="line">        *)</div><div class="line">                error &quot;Unknown command: $opt_command&quot;</div><div class="line">            ;;</div><div class="line">esac</div><div class="line"></div><div class="line">exit 0</div></pre></td></tr></table></figure><br>&#x547D;&#x4EE4;&#x793A;&#x4F8B;&#xFF1A;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo sh bkup_rpimage.sh start -cz /home/pi/NAS/$(uname -n)-$(date +%Y-%m-%d).img</div></pre></td></tr></table></figure></p>
<p>/home/pi/NAS &#x4E3A;&#x5907;&#x4EFD;&#x4F4D;&#x7F6E;&#xFF0C;&#x6309;&#x9700;&#x6C42;&#x4FEE;&#x6539;&#x4F4D;&#x7F6E;&#xFF0C;-c&#x4E3A;&#x65B0;&#x5EFA;&#x5907;&#x4EFD;&#xFF0C; -z&#x4E3A;&#x542F;&#x7528;&#x538B;&#x7F29;&#xFF0C;&#x4F1A;&#x751F;&#x6210;img.gz&#x538B;&#x7F29;&#x6587;&#x4EF6;&#xFF0C;&#x8282;&#x7EA6;&#x7A7A;&#x95F4;&#xFF0C;&#x5176;&#x5B83;&#x9009;&#x9879;&#x53EF;&#x53C2;&#x770B;&#x811A;&#x672C;</p>
<p>&#x65B9;&#x6CD5;&#x4E8C;&#xFF1A;<br>&#x73AF;&#x5883;&#xFF1A;<br>&#x91C7;&#x7528;dd&#x65B9;&#x5F0F;&#x5C06;&#x7CFB;&#x7EDF;&#x5907;&#x4EFD;&#x5230;&#x79FB;&#x52A8;&#x786C;&#x76D8;&#xFF0C;&#x786C;&#x76D8;&#x5DF2;&#x6302;&#x8F7D;&#x5230;/home/pi/NAS</p>
<p>1.&#x9700;&#x8981;&#x7528;&#x5230;&#x7684;&#x8F6F;&#x4EF6;<br>dump&#xFF1A;dump &amp; restore &#x5907;&#x4EFD;&#x5DE5;&#x5177;<br>parted &amp; kpartx&#xFF1A;&#x865A;&#x62DF;&#x78C1;&#x76D8;&#x5DE5;&#x5177;<br><!--more--><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install dump</div><div class="line">sudo apt-get install parted</div><div class="line">sudo apt-get install  kpartx</div></pre></td></tr></table></figure></p>
<p>2.&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x7A7A;&#x767D;&#x7684;img&#x6587;&#x4EF6;<br>&#x9996;&#x5148;&#x67E5;&#x770B;&#x7CFB;&#x7EDF;&#x5360;&#x7528;&#x5927;&#x5C0F;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">df -h</div></pre></td></tr></table></figure></p>
<p>&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x751F;&#x6210;&#x5757;&#x5927;&#x5C0F;&#x4E3A; 1MB &#x603B;&#x5927;&#x5C0F;&#x4E3A; 4000MB &#x7684;&#x955C;&#x50CF;&#x6587;&#x4EF6;&#x5B58;&#x653E;&#x5230;&#x79FB;&#x52A8;&#x786C;&#x76D8;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo dd <span class="keyword">if</span>=/dev/zero of=/home/pi/NAS/pi.img bs=1MB count=4000</div></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x4F1A;&#x82B1;&#x8D39;&#x4E00;&#x5B9A;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x5177;&#x4F53;&#x770B;&#x786C;&#x4EF6;&#x7684;&#x901F;&#x5EA6;</p>
<p>3.&#x5206;&#x5272;&#x865A;&#x62DF;&#x78C1;&#x76D8;<br>&#x67E5;&#x770B;&#x7CFB;&#x7EDF;&#x78C1;&#x76D8;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo fdisk <span class="_">-l</span></div></pre></td></tr></table></figure></p>
<blockquote><p>Device         Boot  Start      End  Sectors  Size Id Type<br>/dev/mmcblk0p1        8192   137215   129024   63M  c W95 FAT32 (LBA)<br>/dev/mmcblk0p2      137216 62333951 62196736 29.7G 83 Linux</p>
</blockquote>
<p>&#x7B2C;&#x4E00;&#x4E2A;&#x5206;&#x5272;&#x533A;&#x91C7;&#x7528; FAT32 &#x683C;&#x5F0F;&#xFF0C;&#x7531; 8192 &#x5230; 137215 &#xFF0C;&#x7EA6; 63MB<br>&#x7B2C;&#x4E8C;&#x4E2A;&#x5206;&#x5272;&#x533A;&#x91C7;&#x7528; EXT4 &#xFF0C;&#x7531; 137216  &#x5F00;&#x59CB;&#x5230;&#x7ED3;&#x675F;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> /home/pi/NAS/</div><div class="line">sudo parted pi.img --script -- mklabel msdos</div><div class="line">sudo parted pi.img --script -- mkpart primary fat32 8192s 137215s</div><div class="line">sudo parted pi.img --script -- mkpart primary ext4 137216s -1</div></pre></td></tr></table></figure></p>
<p>4.&#x6302;&#x8F7D;&#x865A;&#x62DF;&#x78C1;&#x76D8;&#x5E76;&#x683C;&#x5F0F;&#x5316;</p>
<p>opdevice&#xFF1A;&#x6267;&#x884C; losetup &#x8FDE;&#x63A5; img &#x6587;&#x4EF6;&#x7684; loop device<br>device&#xFF1A;&#x6267;&#x884C;&#x5B8C; kpartx &#x540E;&#xFF0C;&#x865A;&#x62DF;&#x78C1;&#x76D8;&#x4EE3;&#x53F7;<br>partBoot&#xFF1A;&#x7531; device &#x52A0;&#x4E0A; p1 &#x7EC4;&#x5408;&#x800C;&#x6210;&#x7684; FAT32 &#x865A;&#x62DF;&#x78C1;&#x76D8;&#x5206;&#x533A;<br>partRoot&#xFF1A;&#x7531; device &#x52A0;&#x4E0A; p2 &#x7EC4;&#x5408;&#x800C;&#x6210;&#x7684; EXT4 &#x865A;&#x62DF;&#x78C1;&#x76D8;&#x5206;&#x533A;<br>&#x5EFA;&#x7ACB;&#x865A;&#x62DF;&#x78C1;&#x76D8;&#x5E76;&#x5206;&#x533A;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">loopdevice=`sudo losetup <span class="_">-f</span> --show pi.img`</div><div class="line">device=`sudo kpartx -va <span class="variable">$loopdevice</span> | sed -E <span class="string">&apos;s/.*(loop[0-9])p.*/\1/g&apos;</span> | head -1`</div><div class="line">device=<span class="string">&quot;/dev/mapper/<span class="variable">${device}</span>&quot;</span></div><div class="line">partBoot=<span class="string">&quot;<span class="variable">${device}</span>p1&quot;</span></div><div class="line">partRoot=<span class="string">&quot;<span class="variable">${device}</span>p2&quot;</span></div></pre></td></tr></table></figure></p>
<p>&#x683C;&#x5F0F;&#x5316;&#x865A;&#x62DF;&#x78C1;&#x76D8;&#x5206;&#x533A;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo mkfs.vfat <span class="variable">$partBoot</span></div><div class="line">sudo mkfs.ext4 <span class="variable">$partRoot</span></div></pre></td></tr></table></figure></p>
<p>5.&#x5907;&#x4EFD;<br>fat32 &#x865A;&#x62DF;&#x78C1;&#x76D8;&#x5206;&#x533A;&#x5EFA;&#x7ACB;&#x597D;&#x540E;&#x76F4;&#x63A5;&#x7528; cp &#x547D;&#x4EE4;&#x5907;&#x4EFD;&#x6587;&#x4EF6;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">sudo mount -t vfat <span class="variable">$partBoot</span> /media</div><div class="line">sudo cp -rfp /boot/* /media/</div><div class="line">sudo umount /media</div></pre></td></tr></table></figure></p>
<p>ext4 linux &#x865A;&#x62DF;&#x78C1;&#x76D8;&#x5206;&#x533A;&#x7528; dump &amp; restore &#x5907;&#x4EFD;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">sudo mount -t ext4 <span class="variable">$partRoot</span> /media/</div><div class="line"><span class="built_in">cd</span> /media</div><div class="line">sudo dump -0uaf - / |  sudo restore -rf -</div><div class="line"><span class="built_in">cd</span></div><div class="line">sudo umount /media</div></pre></td></tr></table></figure></p>
<p>6.&#x5378;&#x8F7D;&#x865A;&#x62DF;&#x5149;&#x9A71;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo kpartx <span class="_">-d</span> <span class="variable">$loopdevice</span></div><div class="line">sudo losetup <span class="_">-d</span> <span class="variable">$loopdevice</span></div></pre></td></tr></table></figure></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[树莓派－python模拟登陆weibo定时发送微博]]></title>
      <url>http://www.hugospi.com/2016-07-22/pythonweibo/</url>
      <content type="html"><![CDATA[<p>&#x5F88;&#x4E45;&#x6CA1;&#x73A9;&#x5FAE;&#x535A;&#xFF0C;&#x6700;&#x8FD1;&#x5165;&#x624B;&#x6811;&#x8393;&#x6D3E;3&#xFF0C;&#x5BF9;&#x7740;&#x7F51;&#x4E0A;&#x5DF2;&#x6709;&#x7684;&#x9879;&#x76EE;&#x5B9E;&#x65BD;&#xFF0C;&#x8FD9;&#x6B21;&#x662F;&#x901A;&#x8FC7;python&#x767B;&#x9646;&#x5FAE;&#x535A;&#x5B9A;&#x65F6;&#x53D1;&#x9001;&#x5FAE;&#x535A;&#x5185;&#x5BB9;&#xFF0C;&#x5BF9;&#x4E8E;24*7&#x5DE5;&#x4F5C;&#x7684;&#x6811;&#x8393;&#x6D3E;&#x6765;&#x8BF4;&#x518D;&#x5408;&#x9002;&#x4E0D;&#x8FC7;&#x4E86;&#x3002;</p>
<p>&#x9879;&#x76EE;&#x5730;&#x5740;&#xFF1A;<a href="https://github.com/HugoChanD/sinaWeibo.git" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/HugoChanD/sinaWeibo.git</a><br><a id="more"></a><br>&#x4EE3;&#x7801;&#x662F;&#x522B;&#x4EBA;&#x5199;&#x597D;&#x7684;&#xFF0C;&#x76F4;&#x63A5;&#x5728;&#x6811;&#x8393;&#x6D3E;&#x4E0A;&#x4E0B;&#x8F7D;&#x4F7F;&#x7528;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#x3002;</p>
<p>&#x4E3B;&#x8981;&#x7ED3;&#x6784;&#x5982;&#x4E0B;&#xFF1A;<br>&#x7A0B;&#x5E8F;&#x5206;&#x4E3A;3&#x4E2A;&#x6A21;&#x5757;&#xFF1A;&#x5FAE;&#x535A;&#x767B;&#x5F55;&#x3001;&#x5B9A;&#x65F6;&#x53D1;&#x5FAE;&#x535A;&#x3001;&#x5FAE;&#x535A;&#x5185;&#x5BB9;&#x751F;&#x4EA7;</p>
<p>&#x4EE3;&#x7801;&#x7ED3;&#x6784;&#x5982;&#x4E0B;&#xFF1A;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">sinaWeibo</div><div class="line">|----main.py</div><div class="line">|----sinaWeiboLogin.py</div><div class="line">|----config.py</div><div class="line">|----logger.py</div><div class="line">|----sendWeibo.py</div><div class="line">|----TextFactory.py</div><div class="line">      |spider</div><div class="line">      |----__init__.py</div><div class="line">      |----utility.py</div><div class="line">      |----http.py</div><div class="line">      |----spider.py</div><div class="line">      |----cnbeta.py          //&#x89E3;&#x6790;cbbeta</div><div class="line">      |----cnblog.py          //&#x89E3;&#x6790;&#x535A;&#x5BA2;&#x56ED;</div><div class="line">      |----techweb.py       /&#x89E3;&#x6790;techweb</div><div class="line">      |----tuicool.py          //&#x89E3;&#x6790;&#x63A8;&#x9177;</div><div class="line">      |----.....                      //&#x66F4;&#x591A;&#x89E3;&#x6790;</div></pre></td></tr></table></figure></p>
<p>&#x4F7F;&#x7528;&#x65B9;&#x6CD5;&#xFF1A;<br>1.&#x4E0B;&#x8F7D;&#x5730;&#x5740;&#xFF1A;<a href="https://github.com/HugoChanD/sinaWeibo.git" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/HugoChanD/sinaWeibo.git</a><br>2.&#x4FEE;&#x6539;&#x914D;&#x7F6E;&#x6587;&#x4EF6;config.py&#xFF0C;&#x628A;&#x5FAE;&#x535A;&#x8D26;&#x53F7;&#x548C;&#x5BC6;&#x7801;&#x6539;&#x4E3A;&#x4F60;&#x81EA;&#x5DF1;&#x7684;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x53D1;&#x9001;&#x65F6;&#x95F4;&#xFF08;&#x9ED8;&#x8BA4;&#x662F;30&#x5206;&#x949F;&#x4E00;&#x6B21;&#xFF09;&#x3002;<br>3.&#x5728;TextFactory.py&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x5FAE;&#x535A;&#x5185;&#x5BB9;&#x751F;&#x6210;&#x89C4;&#x5219;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x9ED8;&#x8BA4;&#x7684;&#x89C4;&#x5219;&#x3002;<br>4.&#x8FD0;&#x884C;main.py&#xFF0C;python main.py&#x3002;</p>
<p>&#x4F9D;&#x8D56;&#xFF1A;<br>&#x8BE5;&#x4EE3;&#x7801;&#x4F7F;&#x7528;&#x4E86;&#x4EE3;&#x7801;&#x4F9D;&#x8D56;requests&#x548C;rsa&#xFF0C;&#x6CA1;&#x6709;&#x5B89;&#x88C5;&#x7684;&#x8BDD;&#x9700;&#x8981;&#x5148;&#x5B89;&#x88C5;&#xFF1A;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">pip install rsa</div><div class="line">pip install requests</div><div class="line">`</div></pre></td></tr></table></figure></p>
<p>&#x6CE8;&#x610F;&#xFF1A;&#x9700;&#x8981;&#x5728;&#x5FAE;&#x535A;&#x5E10;&#x53F7;&#x5B89;&#x5168;&#x4FDD;&#x62A4;&#x4E2D;&#x8BBE;&#x7F6E;&#x4E0D;&#x7528;&#x8F93;&#x5165;&#x9A8C;&#x8BC1;&#x7801;&#x767B;&#x5F55;</p>
<p>&#x5B9A;&#x65F6;&#x53D1;&#x9001;&#x5FAE;&#x535A;<br>&#x65B0;&#x6D6A;&#x5FAE;&#x535A;&#x53D1;&#x5FAE;&#x535A;&#x7684;&#x63A5;&#x53E3;&#x662F;&#xFF1A;<br><a href="http://www.weibo.com/aj/mblog/add?ajwvr=6&amp;__rnd=&#x65F6;&#x95F4;&#x6233;" rel="external nofollow noopener noreferrer" target="_blank">http://www.weibo.com/aj/mblog/add?ajwvr=6&amp;__rnd=&#x65F6;&#x95F4;&#x6233;</a><br>&#x65F6;&#x95F4;&#x6233;&#x4F7F;&#x7528;int(time.time() * 1000&#x5373;&#x53EF;&#x8BBE;&#x7F6E;&#x3002;<br>Post&#x63D0;&#x4EA4;&#x6570;&#x636E;&#xFF1A;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="string">&quot;location&quot;</span> : <span class="string">&quot;v6_content_home&quot;</span>, </div><div class="line"><span class="string">&quot;appkey&quot;</span> : <span class="string">&quot;&quot;</span>, </div><div class="line"><span class="string">&quot;style_type&quot;</span> : <span class="string">&quot;1&quot;</span>, </div><div class="line"><span class="string">&quot;pic_id&quot;</span> : <span class="string">&quot;&quot;</span>, </div><div class="line"><span class="string">&quot;text&quot;</span> : &#x5FAE;&#x535A;&#x5185;&#x5BB9;, </div><div class="line"><span class="string">&quot;pdetail&quot;</span> : <span class="string">&quot;&quot;</span>, </div><div class="line"><span class="string">&quot;rank&quot;</span> : <span class="string">&quot;0&quot;</span>, </div><div class="line"><span class="string">&quot;rankid&quot;</span> : <span class="string">&quot;&quot;</span>, </div><div class="line"><span class="string">&quot;module&quot;</span> : <span class="string">&quot;stissue&quot;</span>, </div><div class="line"><span class="string">&quot;pub_type&quot;</span> : <span class="string">&quot;dialog&quot;</span>, </div><div class="line"><span class="string">&quot;_t&quot;</span> : <span class="string">&quot;0&quot;</span>,</div></pre></td></tr></table></figure></p>
<p>&#x63D0;&#x4EA4;&#x6570;&#x636E;&#x65F6;&#x9700;&#x8981;&#x8BBE;&#x7F6E;Headers:<br>self.http.headers[&#x201C;Referer&#x201D;] = &#x201C;<a href="http://www.weibo.com/u/%s/home?wvr=5" rel="external nofollow noopener noreferrer" target="_blank">http://www.weibo.com/u/%s/home?wvr=5</a>&#x201C; % str(self.uid)<br>uid&#x5728;&#x767B;&#x5F55;&#x65F6;&#x4F1A;&#x8FD4;&#x56DE;&#x3002;<br>&#x5728;Python&#x4E2D;&#x542F;&#x52A8;&#x4E00;&#x4E2A;&#x5B9A;&#x65F6;&#x5668;&#xFF08;Timer&#xFF09;&#xFF0C;&#x6BCF;&#x5F53;&#x5B9A;&#x65F6;&#x5668;&#x89E6;&#x53D1;&#x7684;&#x65F6;&#x5019;&#x5411;&#x8FD9;&#x4E2A;&#x63A5;&#x53E3;Post&#x6570;&#x636E;&#x5C31;&#x80FD;&#x5B9E;&#x73B0;&#x81EA;&#x52A8;&#x53D1;&#x5FAE;&#x535A;&#x4E86;&#x3002;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">def newTimer(self):</div><div class="line">      self.timer = Timer(TIME_SLOG, self.main, ()).start()</div><div class="line"></div><div class="line">def stop(self):</div><div class="line">      <span class="built_in">log</span>(<span class="string">&quot;&#x7ED3;&#x675F;&#x4EFB;&#x52A1;&quot;</span>)</div><div class="line">      self.timer.cancel()</div><div class="line">      pass</div><div class="line"></div><div class="line">def main(self):</div><div class="line">      self.sendWeibo()</div><div class="line"></div><div class="line">      <span class="keyword">if</span> TIMER_REPEAT:</div><div class="line">            self.newTimer()</div><div class="line"></div><div class="line">def sendWeibo(self):</div><div class="line">      text = TextFactory.getText()</div><div class="line">      self.update(text)</div><div class="line">      <span class="built_in">log</span>(u<span class="string">&quot;&#x53D1;&#x9001;&#x5FAE;&#x535A;&#xFF1A;&quot;</span> + text)</div></pre></td></tr></table></figure>
<p>&#x5B9A;&#x4E49;&#x5FAE;&#x535A;&#x5185;&#x5BB9;<br>TextFactory.py&#x6587;&#x4EF6;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">spiders = [</div><div class="line">      Spider(miaopai.HOME_URL, miaopai.MiaopaParser()),</div><div class="line">      Spider(cnbeta.HOME_URL, cnbeta.CnbetaParser()),</div><div class="line">      Spider(cnblog.HOME_URL, cnblog.CnblogParser()),</div><div class="line">      Spider(techweb.HOME_URL, techweb.TechwebParser()),</div><div class="line">      Spider(tuicool.HOME_URL, tuicool.TuicoolParser()),</div><div class="line">      Spider(miaopai.HOME_URL, miaopai.MiaopaParser()),</div><div class="line">]</div><div class="line"></div><div class="line">currentIndex = 0</div><div class="line">count = len(spiders)</div><div class="line"></div><div class="line">def getText():</div><div class="line">      spider = nextSpider()</div><div class="line">      text = spider.getAMessage()</div><div class="line">      <span class="built_in">return</span> text</div><div class="line"></div><div class="line">def nextSpider():</div><div class="line">      global currentIndex</div><div class="line">      spider = spiders[currentIndex]</div><div class="line">      currentIndex = (currentIndex + 1) % count</div><div class="line">      <span class="built_in">return</span> spider</div></pre></td></tr></table></figure></p>
<p>&#x6700;&#x540E;&#x6DFB;&#x52A0;&#x5F00;&#x673A;&#x81EA;&#x52A8;&#x542F;&#x52A8;python&#x6587;&#x4EF6;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;</p>
<p>&#x5F15;&#x7528;&#x539F;&#x4F5C;&#x8005;&#x94FE;&#x63A5;&#xFF1A;<a href="http://blog.5long.me/2015/code-login-sina-weibo-update-weibo/" rel="external nofollow noopener noreferrer" target="_blank">http://blog.5long.me/2015/code-login-sina-weibo-update-weibo/</a></p>
<p>&#xFF0D;&#xFF0D;&#xFF0D;&#xFF0D;&#xFF0D;&#xFF0D;&#xFF0D;&#xFF0D;&#xFF0D;&#xFF0D;2016-09-07&#x66F4;&#x65B0;&#x5206;&#x754C;&#x7EBF;&#xFF0D;&#xFF0D;&#xFF0D;&#xFF0D;&#xFF0D;&#xFF0D;&#xFF0D;&#xFF0D;&#xFF0D;&#xFF0D;<br>&#x9644;&#x4E0A;&#x53E6;&#x5916;&#x4E00;&#x4E2A;weibo&#x5BA2;&#x6237;&#x7AEF;<br>&#x9879;&#x76EE;&#x5730;&#x5740;&#xFF1A;<a href="https://github.com/zhuzhezhe/weibobash" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/zhuzhezhe/weibobash</a></p>
<p>&#x76F4;&#x63A5;&#x5B89;&#x88C5; $pip install weibobash</p>
<p>&#x4F7F;&#x7528;</p>
<p>&#x52A1;&#x5FC5;&#x9996;&#x5148;&#x8FD0;&#x884C;$weibobash -u&#x8F93;&#x5165;&#x7528;&#x6237;&#x540D;&#x548C;&#x5BC6;&#x7801;&#x4EE5;&#x767B;&#x9646;</p>
<p>&#x547D;&#x4EE4;&#x4E0B;&#x4F7F;&#x7528;$weibobash &lt;&#x53C2;&#x6570;&gt;&#x8FD0;&#x884C;&#x76F8;&#x5E94;&#x529F;&#x80FD;&#x3002;</p>
<p>&#x2014;&#x2014;&#x2013;weibobash&#x4F7F;&#x7528;&#x5E2E;&#x52A9;&#x2014;&#x2014;&#x2013;</p>
<p>-h&lt;&#x2013;help&gt;: &#x663E;&#x793A;&#x5E2E;&#x52A9;&#x4FE1;&#x606F;</p>
<p>-u&lt;&#x2013;user&gt;: &#x8F93;&#x5165;&#x7528;&#x6237;&#x540D;&#x548C;&#x5BC6;&#x7801;</p>
<p>-n&lt;&#x2013;new&gt;: &#x663E;&#x793A;20&#x6761;&#x6700;&#x65B0;&#x5FAE;&#x535A;</p>
<p>-a&lt;&#x2013;add&gt;: &#x53D1;&#x5E03;&#x4E00;&#x6761;&#x5FAE;&#x535A;</p>
<p>&#x5185;&#x5BB9;&#x53EF;&#x4EE5;&#x81EA;&#x5B9A;&#x4E49;&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x4F7F;&#x7528;&#x7684;&#x662F;&#x5B9A;&#x65F6;&#x5929;&#x6C14;&#x9884;&#x62A5;&#x8DDF;&#x8282;&#x5047;&#x65E5;&#x4FE1;&#x606F;&#x8DDF;&#x6811;&#x8393;&#x6D3E;&#x7684;cpu&#x6E29;&#x5EA6;&#x7B49;&#x4FE1;&#x606F;</p>
<p>python&#x76F4;&#x63A5;&#x8C03;&#x7528;os.system weibobash -a  &#x5185;&#x5BB9;&#xFF0C;crontab&#x6DFB;&#x52A0;&#x5B9A;&#x65F6;&#x53D1;&#x5E03;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[树莓派-定时天气播报]]></title>
      <url>http://www.hugospi.com/2016-07-22/weather/</url>
      <content type="html"><![CDATA[<p>&#x6811;&#x8393;&#x6D3E;&#x83B7;&#x53D6;&#x548C;&#x98CE;&#x5929;&#x6C14;&#x6570;&#x636E;&#xFF0C;&#x7136;&#x540E;&#x901A;&#x8FC7;&#x767E;&#x5EA6;&#x8BED;&#x97F3;&#x5408;&#x6210;&#xFF0C;&#x8BBE;&#x7F6E;&#x5B9A;&#x65F6;&#x5929;&#x6C14;&#x64AD;&#x62A5;</p>
<p>1.&#x9996;&#x5148;&#x8981;&#x7533;&#x8BF7;&#x548C;&#x98CE;&#x5929;&#x6C14;api&#x548C;&#x767E;&#x5EA6;&#x8BED;&#x97F3;&#x5408;&#x6210;api<br>  &#x548C;&#x98CE;&#x5929;&#x6C14;&#xFF1A;<a href="http://www.heweather.com" rel="external nofollow noopener noreferrer" target="_blank">http://www.heweather.com</a><br>    &#x6CE8;&#x518C;&#x83B7;&#x53D6;&#x7528;&#x6237;&#x8BA4;&#x8BC1;key<br>  &#x767E;&#x5EA6;&#x8BED;&#x97F3;&#xFF1A;<a href="http://yuyin.baidu.com/tts/" rel="external nofollow noopener noreferrer" target="_blank">http://yuyin.baidu.com/tts/</a><br>    &#x6CE8;&#x518C;&#x83B7;&#x53D6;api key&#x8DDF;Secret Key<br><a id="more"></a><br>&#x5177;&#x4F53;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line">import os</div><div class="line">import urllib</div><div class="line">import urllib2,json</div><div class="line">from datetime import date</div><div class="line">from os import path</div><div class="line">import sys</div><div class="line">reload(sys)</div><div class="line">sys.setdefaultencoding(<span class="string">&apos;utf-8&apos;</span>)</div><div class="line"></div><div class="line">def get_city_id(cityname, search_<span class="built_in">type</span>=1):</div><div class="line">    ids = <span class="string">&apos;&apos;</span></div><div class="line">    <span class="keyword">if</span> search_<span class="built_in">type</span> == 1:<span class="comment"># &#x67E5;&#x8BE2;&#x57CE;&#x5E02;ID</span></div><div class="line">        search = <span class="string">&apos;allchina&apos;</span></div><div class="line">        fn0 = <span class="string">&apos;cityID&apos;</span></div><div class="line">    <span class="keyword">elif</span> search_<span class="built_in">type</span> == 0:<span class="comment"># &#x67E5;&#x8BE2;&#x666F;&#x70B9;ID</span></div><div class="line">        fn0 = <span class="string">&apos;viewID&apos;</span></div><div class="line">        search = <span class="string">&apos;allattractions&apos;</span></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="comment"># &#x4EE3;&#x8868;type&#x503C;&#x51FA;&#x9519;</span></div><div class="line">        <span class="built_in">return</span> -1</div><div class="line">    fn = fn0+str(date.today())+<span class="string">&apos;.txt&apos;</span></div><div class="line">    try:</div><div class="line">        <span class="keyword">if</span> path.exists(fn):</div><div class="line">            fp = open(fn, <span class="string">&apos;r&apos;</span>)</div><div class="line">            context = fp.read()</div><div class="line">            fp.close()</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            fp = open(fn, <span class="string">&apos;w&apos;</span>)</div><div class="line">            url_city = <span class="string">&apos;https://api.heweather.com/x3/citylist?search=&apos;</span>+search+<span class="string">&apos;&amp;key=ae7baaf41f1b4b30b843f278869ab903&apos;</span></div><div class="line">            req = urllib2.Request(url_city)</div><div class="line">            resp = urllib2.urlopen(req)</div><div class="line">            context = resp.read().decode(<span class="string">&apos;utf-8&apos;</span>)</div><div class="line">            <span class="comment"># print True</span></div><div class="line">            fp.write(context)</div><div class="line">            fp.close()</div><div class="line"></div><div class="line">        city_json = json.loads(context,encoding=<span class="string">&apos;utf-8&apos;</span>)</div><div class="line">        city_info = city_json[<span class="string">&quot;city_info&quot;</span>]</div><div class="line">        city_name = unicode(cityname, <span class="string">&apos;utf-8&apos;</span>)</div><div class="line">        <span class="comment"># print city_name</span></div><div class="line">        <span class="keyword">for</span> index, cities <span class="keyword">in</span> enumerate(city_info):</div><div class="line">            <span class="keyword">if</span> city_name <span class="keyword">in</span> cities[<span class="string">&apos;city&apos;</span>]:</div><div class="line">                <span class="built_in">print</span> cities[<span class="string">&apos;city&apos;</span>]</div><div class="line">                ids = cities[<span class="string">&apos;id&apos;</span>]</div><div class="line">                <span class="built_in">break</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="comment"># &#x4E4B;&#x540E;&#x5C06;&#x4F1A;&#x8FD4;&#x56DE;-1</span></div><div class="line">            <span class="built_in">print</span> <span class="string">&apos;&#x60A8;&#x8F93;&#x5165;&#x7684;&#x57CE;&#x5E02;&#x6216;&#x666F;&#x70B9;&#x4E0D;&#x5B58;&#x5728;&#xFF0C;&#x8BF7;&#x53CD;&#x9988;&#x7ED9;&#x7BA1;&#x7406;&#x5458;&apos;</span></div><div class="line">    except IOError, e:</div><div class="line">        <span class="built_in">print</span> e</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        pass</div><div class="line">    <span class="built_in">return</span> ids</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#&#x8FD4;&#x56DE;&#x548C;&#x98CE;&#x5929;&#x6C14;&#x6570;&#x636E;</span></div><div class="line">def get_city_weather(index, search_<span class="built_in">type</span>=1):</div><div class="line"></div><div class="line">    <span class="keyword">if</span> search_<span class="built_in">type</span> == 1:</div><div class="line">        search = <span class="string">&apos;weather&apos;</span></div><div class="line">    <span class="keyword">elif</span> search_<span class="built_in">type</span> == 0:</div><div class="line">        search = <span class="string">&apos;attractions&apos;</span></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="built_in">return</span> -1</div><div class="line">    url_weather = <span class="string">&apos;https://api.heweather.com/x3/&apos;</span>+search+<span class="string">&apos;?cityid=&apos;</span>+index+<span class="string">&apos;&amp;key=&#x548C;&#x98CE;&#x5929;&#x6C14;key&apos;</span></div><div class="line">    req = urllib2.Request(url_weather)</div><div class="line">    resp = urllib2.urlopen(req)</div><div class="line">    context = resp.read()</div><div class="line">    weather_json = json.loads(context, encoding=<span class="string">&apos;utf-8&apos;</span>)</div><div class="line">    fp = open(<span class="string">&quot;/home/pi/python/tianqi/test.txt&quot;</span>, <span class="string">&apos;w&apos;</span>)</div><div class="line">    fp.write(context)</div><div class="line">    fp.close()</div><div class="line">    <span class="keyword">if</span> search_<span class="built_in">type</span> == 1:</div><div class="line">        weather = weather_json[<span class="string">&quot;HeWeather data service 3.0&quot;</span>][0][<span class="string">&apos;daily_forecast&apos;</span>][0]</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        weather = weather_json</div><div class="line">    <span class="built_in">return</span> weather</div><div class="line"></div><div class="line"><span class="comment">#&#x83B7;&#x53D6;&#x767E;&#x5EA6;&#x8BED;&#x97F3;token</span></div><div class="line">def get_token():</div><div class="line">    api_key = <span class="string">&quot;&#x767E;&#x5EA6;API Key&quot;</span></div><div class="line">    sec_key = <span class="string">&quot;&#x767E;&#x5EA6;Secret Key&quot;</span></div><div class="line">    url = url=<span class="string">&quot;https://openapi.baidu.com/oauth/2.0/token?grant_type=client_credentials&amp;client_id=&quot;</span>+api_key+<span class="string">&quot;&amp;client_secret=&quot;</span>+sec_key</div><div class="line">    req = urllib2.Request(url)</div><div class="line">    resp = urllib2.urlopen(req)</div><div class="line">    context = resp.read().decode(<span class="string">&apos;utf-8&apos;</span>)</div><div class="line">    <span class="built_in">return</span> json.loads(context)[<span class="string">&apos;access_token&apos;</span>]</div><div class="line"></div><div class="line"><span class="comment">#&#x83B7;&#x53D6;&#x9700;&#x8981;&#x7684;&#x6570;&#x636E;</span></div><div class="line">def get_wat():</div><div class="line">    city_id = <span class="string">&quot;CN101280101&quot;</span>  <span class="comment">#&#x5E7F;&#x5DDE;&#x5929;&#x6C14;&#x4EE3;&#x7801;   </span></div><div class="line">    city_weather = get_city_weather(city_id)</div><div class="line">    a= city_weather[<span class="string">&apos;tmp&apos;</span>][<span class="string">&apos;max&apos;</span>]</div><div class="line">    b= city_weather[<span class="string">&apos;tmp&apos;</span>][<span class="string">&apos;min&apos;</span>]</div><div class="line">    c= city_weather[<span class="string">&apos;cond&apos;</span>][<span class="string">&apos;txt_d&apos;</span>]</div><div class="line">    d= city_weather[<span class="string">&apos;cond&apos;</span>][<span class="string">&apos;txt_n&apos;</span>]</div><div class="line">    e= city_weather[<span class="string">&apos;date&apos;</span>]</div><div class="line">    <span class="built_in">return</span> <span class="string">&quot;&#x5929;&#x6C14;&#x9884;&#x62A5;  &#x4ECA;&#x5929;&#x662F; {}   &#x6700;&#x9AD8;&#x6E29;&#x5EA6;{} &#x6700;&#x4F4E;&#x6E29;&#x5EA6;{} &#x65E5;&#x95F4;&#x5929;&#x6C14;{} &#x591C;&#x95F4;&#x5929;&#x6C14;{}&quot;</span>.format(e,a,b,c,d)</div><div class="line"></div><div class="line">token=get_token()</div><div class="line">weather=get_wat() </div><div class="line"></div><div class="line"><span class="comment">#tts</span></div><div class="line">url = <span class="string">&quot;http://tsn.baidu.com/text2audio?tex=&quot;</span>+weather+<span class="string">&quot;&amp;lan=zh&amp;per=0&amp;pit=1&amp;spd=4&amp;cuid=b827ebcac3a2&amp;ctp=1&amp;tok=&quot;</span>+token</div><div class="line"></div><div class="line"><span class="comment">#&#x64AD;&#x653E;</span></div><div class="line">try:</div><div class="line">    os.system(<span class="string">&apos;/usr/bin/mplayer &quot;%s&quot;&apos;</span> %(url))</div><div class="line">except Exception as e:</div><div class="line">    <span class="built_in">print</span>(<span class="string">&apos;Exception&apos;</span>,e)</div></pre></td></tr></table></figure>
<p>&#x6700;&#x540E;&#x901A;&#x8FC7;crontab&#x5B9A;&#x65F6;&#x542F;&#x52A8;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">30 7 * * * sudo python /home/pi/python/weather.py</div></pre></td></tr></table></figure></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Hello World]]></title>
      <url>http://www.hugospi.com/2016-07-21/hello-world/</url>
      <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" rel="external nofollow noopener noreferrer" target="_blank">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" rel="external nofollow noopener noreferrer" target="_blank">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" rel="external nofollow noopener noreferrer" target="_blank">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" rel="external nofollow noopener noreferrer" target="_blank">GitHub</a>.</p>
<h2 id="quick-start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" rel="external nofollow noopener noreferrer" target="_blank">Writing</a></p>
<h3 id="run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" rel="external nofollow noopener noreferrer" target="_blank">Server</a></p>
<h3 id="generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" rel="external nofollow noopener noreferrer" target="_blank">Generating</a></p>
<h3 id="deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" rel="external nofollow noopener noreferrer" target="_blank">Deployment</a></p>
]]></content>
    </entry>
    
  
  
</search>
